<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OWASP Cebu - ASVS v5.0 Workshop</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Dark theme (default) */
            --bg-gradient-start: #0f172a;
            --bg-gradient-mid: #1e293b;
            --bg-gradient-end: #0f172a;
            --overlay-blue: rgba(59, 130, 246, 0.1);
            --overlay-purple: rgba(139, 92, 246, 0.1);
            --grid-opacity: 0.03;
            --grid-vignette: rgba(15, 23, 42, 0.5);
            --grid-overall-opacity: 0.4;
            --link-color: #93c5fd;
            --link-border: rgba(147, 197, 253, 0.3);
            --link-hover: #60a5fa;
            --link-hover-border: rgba(96, 165, 250, 0.6);
            --link-hover-shadow: 0 0 8px rgba(96, 165, 250, 0.4);
            --link-visited: #a78bfa;
            --slide-bg-start: #1e293b;
            --slide-bg-end: #0f172a;
            --slide-border: rgba(59, 130, 246, 0.2);
            --slide-border-width: 1px;
            --slide-shadow-ring: rgba(59, 130, 246, 0.1);
            --slide-shadow-main: rgba(0, 0, 0, 0.5);
            --slide-inset: rgba(255, 255, 255, 0.05);
            --h1-color: #60a5fa;
            --h1-shadow: 0 0 30px rgba(96, 165, 250, 0.3);
            --h2-color: #60a5fa;
            --h2-border: rgba(59, 130, 246, 0.3);
            --h2-border-width: 2px;
            --h2-shadow: 0 0 20px rgba(96, 165, 250, 0.2);
            --h3-color: #a78bfa;
            --h4-color: #94a3b8;
            --text-color: #cbd5e1;
            --subtitle-color: #94a3b8;
            --user-story-bg: rgba(59, 130, 246, 0.15);
            --user-story-border: rgba(59, 130, 246, 0.2);
            --user-story-text: #e2e8f0;
            --vulnerability-bg: rgba(239, 68, 68, 0.1);
            --vulnerability-border: rgba(239, 68, 68, 0.2);
            --secure-bg: rgba(34, 197, 94, 0.1);
            --secure-border: rgba(34, 197, 94, 0.2);
            --asvs-bg: rgba(251, 146, 60, 0.1);
            --asvs-border: rgba(251, 146, 60, 0.3);
            --asvs-h4: #fb923c;
            --code-bg: rgba(15, 23, 42, 0.8);
            --code-text: #e2e8f0;
            --code-border: rgba(59, 130, 246, 0.2);
            --code-border-width: 1px;
            --code-shadow: rgba(0, 0, 0, 0.3);
            --comment-color: #6a9955;
            --keyword-color: #569cd6;
            --string-color: #ce9178;
            --btn-bg: rgba(59, 130, 246, 0.08);
            --btn-color: rgba(96, 165, 250, 0.7);
            --btn-border: rgba(59, 130, 246, 0.2);
            --btn-border-width: 1px;
            --btn-opacity: 0.6;
            --btn-hover-bg: rgba(59, 130, 246, 0.15);
            --btn-hover-border: rgba(59, 130, 246, 0.4);
            --btn-hover-color: rgba(96, 165, 250, 0.9);
            --btn-hover-opacity: 1;
            --btn-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
            --btn-disabled-bg: rgba(59, 130, 246, 0.05);
            --btn-disabled-opacity: 0.2;
            --card-bg: rgba(30, 41, 59, 0.5);
            --card-border: rgba(59, 130, 246, 0.2);
            --card-border-width: 1px;
            --card-shadow: none;
            --card-h-color: #60a5fa;
            --card-text: #e2e8f0;
            --badge-bg: rgba(59, 130, 246, 0.2);
            --badge-color: #60a5fa;
            --badge-border: rgba(59, 130, 246, 0.3);
            --badge-danger-bg: rgba(239, 68, 68, 0.2);
            --badge-danger-color: #f87171;
            --badge-danger-border: rgba(239, 68, 68, 0.3);
            --badge-success-bg: rgba(34, 197, 94, 0.2);
            --badge-success-color: #4ade80;
            --badge-success-border: rgba(34, 197, 94, 0.3);
            --badge-warning-bg: rgba(251, 146, 60, 0.2);
            --badge-warning-color: #fb923c;
            --badge-warning-border: rgba(251, 146, 60, 0.3);
            --highlight-bg: rgba(251, 191, 36, 0.15);
            --highlight-border: rgba(251, 191, 36, 0.5);
            --highlight-text: #fef3c7;
            --highlight-title-color: #fef3c7;
            --checklist-check: #22c55e;
            --timeline-bg: rgba(30, 41, 59, 0.5);
            --timeline-border: rgba(59, 130, 246, 0.2);
            --timeline-border-width: 1px;
            --timeline-text: #e2e8f0;
            --timeline-time-bg: rgba(59, 130, 246, 0.2);
            --timeline-time-color: #60a5fa;
            --timeline-time-border: rgba(59, 130, 246, 0.3);
            --key-point-bg: rgba(59, 130, 246, 0.15);
            --key-point-color: #60a5fa;
            --key-point-border: rgba(59, 130, 246, 0.3);
            --key-point-border-width: 1px;
            --key-point-shadow: 0 0 30px rgba(59, 130, 246, 0.1);
            --comparison-bad-bg: rgba(239, 68, 68, 0.1);
            --comparison-bad-border: rgba(239, 68, 68, 0.3);
            --comparison-good-bg: rgba(34, 197, 94, 0.1);
            --comparison-good-border: rgba(34, 197, 94, 0.3);
            --scroll-indicator: #64748b;
            --selector-bg: rgba(15, 23, 42, 0.95);
            --selector-border: rgba(59, 130, 246, 0.3);
            --selector-border-width: 1px;
            --selector-shadow: rgba(0, 0, 0, 0.6);
            --selector-inset: rgba(255, 255, 255, 0.05);
            --selector-item-color: #cbd5e1;
            --selector-item-hover-bg: rgba(59, 130, 246, 0.15);
            --selector-item-hover-color: #e2e8f0;
            --selector-item-current-bg: rgba(59, 130, 246, 0.2);
            --selector-item-current-color: #60a5fa;
            --selector-item-current-border: #60a5fa;
            --selector-header-bg: rgba(59, 130, 246, 0.2);
            --selector-header-color: #60a5fa;
            --selector-header-border: rgba(59, 130, 246, 0.3);
            --badge-float-bg: rgba(30, 41, 59, 0.85);
            --badge-float-shadow: rgba(0, 0, 0, 0.3);
            --glow-opacity: 0.2;
            --resources-card-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --resources-card-text: #ffffff;
            --resources-link-color: #fef3c7;
            --resources-link-hover: #fde68a;
            --shield-opacity: 0.12;
            --shield-shadow: rgba(59, 130, 246, 0.5);
            --line-number-color: #64748b;
            --line-number-bg: #0f172a;
            --line-number-hover-bg: #1a2332;
            --line-number-selected-bg: #1e2738;
            --line-number-border: rgba(59, 130, 246, 0.2);
            --code-line-hover-bg: rgba(59, 130, 246, 0.08);
            --code-line-selected-bg: rgba(59, 130, 246, 0.15);
        }

        body.light-theme {
            --bg-gradient-start: #f8fafc;
            --bg-gradient-mid: #e2e8f0;
            --bg-gradient-end: #f1f5f9;
            --overlay-blue: rgba(59, 130, 246, 0.08);
            --overlay-purple: rgba(139, 92, 246, 0.08);
            --grid-opacity: 0.02;
            --grid-vignette: transparent;
            --grid-overall-opacity: 0.5;
            --link-color: #2563eb;
            --link-border: rgba(37, 99, 235, 0.3);
            --link-hover: #1d4ed8;
            --link-hover-border: rgba(29, 78, 216, 0.6);
            --link-hover-shadow: none;
            --link-visited: #7c3aed;
            --slide-bg-start: #ffffff;
            --slide-bg-end: #f8fafc;
            --slide-border: rgba(59, 130, 246, 0.15);
            --slide-border-width: 2px;
            --slide-shadow-ring: rgba(59, 130, 246, 0.08);
            --slide-shadow-main: rgba(15, 23, 42, 0.12);
            --slide-inset: rgba(255, 255, 255, 0.9);
            --h1-color: #1e40af;
            --h1-shadow: 0 2px 4px rgba(30, 64, 175, 0.1);
            --h2-color: #1e40af;
            --h2-border: rgba(59, 130, 246, 0.2);
            --h2-border-width: 3px;
            --h2-shadow: none;
            --h3-color: #7c3aed;
            --h4-color: #475569;
            --text-color: #334155;
            --subtitle-color: #64748b;
            --user-story-bg: rgba(59, 130, 246, 0.08);
            --user-story-border: rgba(59, 130, 246, 0.15);
            --user-story-text: #1e293b;
            --vulnerability-bg: rgba(239, 68, 68, 0.08);
            --vulnerability-border: rgba(239, 68, 68, 0.15);
            --secure-bg: rgba(34, 197, 94, 0.08);
            --secure-border: rgba(34, 197, 94, 0.15);
            --asvs-bg: rgba(251, 146, 60, 0.08);
            --asvs-border: rgba(251, 146, 60, 0.2);
            --asvs-h4: #ea580c;
            --code-bg: #f8fafc;
            --code-text: #1e293b;
            --code-border: rgba(59, 130, 246, 0.15);
            --code-border-width: 2px;
            --code-shadow: rgba(0, 0, 0, 0.05);
            --comment-color: #16a34a;
            --keyword-color: #2563eb;
            --string-color: #dc2626;
            --btn-bg: rgba(255, 255, 255, 0.4);
            --btn-color: #64748b;
            --btn-border: rgba(148, 163, 184, 0.15);
            --btn-border-width: 1px;
            --btn-opacity: 0.9;
            --btn-hover-bg: rgba(59, 130, 246, 0.08);
            --btn-hover-border: rgba(59, 130, 246, 0.3);
            --btn-hover-color: #1e40af;
            --btn-hover-opacity: 1;
            --btn-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
            --btn-disabled-bg: rgba(255, 255, 255, 0.7);
            --btn-disabled-opacity: 0.3;
            --card-bg: rgba(248, 250, 252, 0.8);
            --card-border: rgba(59, 130, 246, 0.15);
            --card-border-width: 2px;
            --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            --card-h-color: #1e40af;
            --card-text: #334155;
            --badge-bg: rgba(59, 130, 246, 0.12);
            --badge-color: #1e40af;
            --badge-border: rgba(59, 130, 246, 0.2);
            --badge-danger-bg: rgba(239, 68, 68, 0.12);
            --badge-danger-color: #dc2626;
            --badge-danger-border: rgba(239, 68, 68, 0.2);
            --badge-success-bg: rgba(34, 197, 94, 0.12);
            --badge-success-color: #16a34a;
            --badge-success-border: rgba(34, 197, 94, 0.2);
            --badge-warning-bg: rgba(251, 146, 60, 0.12);
            --badge-warning-color: #ea580c;
            --badge-warning-border: rgba(251, 146, 60, 0.2);
            --highlight-bg: rgba(251, 191, 36, 0.12);
            --highlight-border: rgba(251, 191, 36, 0.4);
            --highlight-text: #92400e;
            --highlight-title-color: #92400e;
            --checklist-check: #16a34a;
            --timeline-bg: rgba(248, 250, 252, 0.8);
            --timeline-border: rgba(59, 130, 246, 0.15);
            --timeline-border-width: 2px;
            --timeline-text: #334155;
            --timeline-time-bg: rgba(59, 130, 246, 0.12);
            --timeline-time-color: #1e40af;
            --timeline-time-border: rgba(59, 130, 246, 0.2);
            --key-point-bg: rgba(59, 130, 246, 0.1);
            --key-point-color: #1e40af;
            --key-point-border: rgba(59, 130, 246, 0.2);
            --key-point-border-width: 2px;
            --key-point-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
            --comparison-bad-bg: rgba(239, 68, 68, 0.08);
            --comparison-bad-border: rgba(239, 68, 68, 0.2);
            --comparison-good-bg: rgba(34, 197, 94, 0.08);
            --comparison-good-border: rgba(34, 197, 94, 0.2);
            --scroll-indicator: #94a3b8;
            --selector-bg: rgba(255, 255, 255, 0.98);
            --selector-border: rgba(59, 130, 246, 0.2);
            --selector-border-width: 2px;
            --selector-shadow: rgba(15, 23, 42, 0.15);
            --selector-inset: transparent;
            --selector-item-color: #334155;
            --selector-item-hover-bg: rgba(59, 130, 246, 0.08);
            --selector-item-hover-color: #1e293b;
            --selector-item-current-bg: rgba(59, 130, 246, 0.12);
            --selector-item-current-color: #1e40af;
            --selector-item-current-border: #3b82f6;
            --selector-header-bg: rgba(59, 130, 246, 0.12);
            --selector-header-color: #1e40af;
            --selector-header-border: rgba(59, 130, 246, 0.2);
            --badge-float-bg: rgba(255, 255, 255, 0.95);
            --badge-float-shadow: rgba(0, 0, 0, 0.1);
            --shield-opacity: 0.1;
            --shield-shadow: rgba(59, 130, 246, 0.3);
            --glow-opacity: 0.15;
            --resources-card-bg: linear-gradient(135deg, #93c5fd 0%, #a5b4fc 100%);
            --resources-card-text: #1e293b;
            --resources-link-color: #1e40af;
            --resources-link-hover: #3b82f6;
            --line-number-color: #94a3b8;
            --line-number-bg: #f8fafc;
            --line-number-hover-bg: #e8f0fe;
            --line-number-selected-bg: #dce7fc;
            --line-number-border: rgba(59, 130, 246, 0.15);
            --code-line-hover-bg: rgba(59, 130, 246, 0.05);
            --code-line-selected-bg: rgba(59, 130, 246, 0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-mid) 50%, var(--bg-gradient-end) 100%);
            overflow: hidden;
            height: 100vh;
            position: relative;
            transition: background 0.3s ease;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, var(--overlay-blue) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, var(--overlay-purple) 0%, transparent 50%);
            pointer-events: none;
            transition: background 0.3s ease;
        }

        body::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(59, 130, 246, var(--grid-opacity)) 2px, rgba(59, 130, 246, var(--grid-opacity)) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(59, 130, 246, var(--grid-opacity)) 2px, rgba(59, 130, 246, var(--grid-opacity)) 4px),
                radial-gradient(circle at 50% 50%, transparent 0%, var(--grid-vignette) 100%);
            opacity: var(--grid-overall-opacity);
            pointer-events: none;
            transition: opacity 0.3s ease, background-image 0.3s ease;
        }

        a {
            color: var(--link-color);
            text-decoration: none;
            border-bottom: 1px solid var(--link-border);
            transition: all 0.3s ease;
        }

        a:hover {
            color: var(--link-hover);
            border-bottom-color: var(--link-hover-border);
            text-shadow: var(--link-hover-shadow);
        }

        a:visited {
            color: var(--link-visited);
        }

        .presentation {
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .slide {
            background: linear-gradient(135deg, var(--slide-bg-start) 0%, var(--slide-bg-end) 100%);
            border: var(--slide-border-width) solid var(--slide-border);
            width: 95%;
            max-width: 1400px;
            height: 88vh;
            border-radius: 16px;
            box-shadow: 
                0 0 0 1px var(--slide-shadow-ring),
                0 20px 60px var(--slide-shadow-main),
                inset 0 1px 0 var(--slide-inset);
            padding: 0;
            display: none;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
        }

        .slide > h2 {
            position: sticky;
            top: 0;
            z-index: 10;
            background: linear-gradient(135deg, var(--slide-bg-start) 0%, var(--slide-bg-end) 100%);
            backdrop-filter: blur(20px);
            padding: 35px 70px 15px 70px;
            margin: 0;
            border-bottom: var(--h2-border-width) solid var(--h2-border);
            border-radius: 16px 16px 0 0;
        }

        .slide-content {
            flex: 1;
            overflow: auto;
            padding: 30px 70px 50px 70px;
            scrollbar-width: thin;
            scrollbar-color: transparent transparent;
            transition: scrollbar-color 0.3s ease;
            min-height: 0;
            min-width: 0;
        }

        /* Show scrollbar on hover or active scroll */
        .slide-content:hover,
        .slide-content:active,
        .slide-content:focus-within {
            scrollbar-color: var(--line-number-border) transparent;
        }

        /* WebKit scrollbar styling for slide content */
        .slide-content::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .slide-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .slide-content::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .slide-content:hover::-webkit-scrollbar-thumb,
        .slide-content:active::-webkit-scrollbar-thumb,
        .slide-content:focus-within::-webkit-scrollbar-thumb {
            background: var(--line-number-border);
        }

        .slide-content::-webkit-scrollbar-thumb:hover {
            background: var(--h2-color);
        }

        .slide-content::-webkit-scrollbar-corner {
            background: transparent;
        }

        /* Reduce top padding for slides with code blocks to maximize screen space */
        .slide-content:has(> .code-block:first-child) {
            padding-top: 10px;
        }

        .slide-content::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .slide-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .slide-content::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .slide-content:hover::-webkit-scrollbar-thumb,
        .slide-content:active::-webkit-scrollbar-thumb {
            background: var(--line-number-border);
        }

        .slide-content::-webkit-scrollbar-thumb:hover {
            background: var(--h2-color);
        }

        .slide-content::-webkit-scrollbar-corner {
            background: transparent;
        }

        .slide.active {
            display: flex;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-header {
            margin-bottom: 40px;
        }

        h1 {
            color: var(--h1-color);
            font-size: 3em;
            margin-bottom: 20px;
            font-weight: 700;
            text-shadow: var(--h1-shadow);
            transition: color 0.3s ease, text-shadow 0.3s ease;
        }

        h2 {
            color: var(--h2-color);
            font-size: 2.5em;
            margin-bottom: 30px;
            border-bottom: var(--h2-border-width) solid var(--h2-border);
            padding-bottom: 15px;
            font-weight: 700;
            text-shadow: var(--h2-shadow);
            transition: all 0.3s ease;
        }

        h3 {
            color: var(--h3-color);
            font-size: 1.8em;
            margin-top: 25px;
            margin-bottom: 15px;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        h4 {
            color: var(--h4-color);
            font-size: 1.3em;
            margin-top: 20px;
            margin-bottom: 10px;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        p, li {
            color: var(--text-color);
            font-size: 1.2em;
            line-height: 1.8;
            margin-bottom: 15px;
            transition: color 0.3s ease;
        }

        ul {
            margin-left: 40px;
            margin-bottom: 20px;
        }

        .subtitle {
            color: var(--subtitle-color);
            font-size: 1.5em;
            font-style: italic;
            transition: color 0.3s ease;
        }

        .user-story {
            background: var(--user-story-bg);
            border-left: 4px solid #3b82f6;
            padding: 20px;
            margin: 25px 0;
            border-radius: 8px;
            font-style: italic;
            font-size: 1.3em;
            border: 1px solid var(--user-story-border);
            color: var(--user-story-text);
            transition: all 0.3s ease;
        }

        .vulnerability-box {
            background: var(--vulnerability-bg);
            border-left: 4px solid #ef4444;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid var(--vulnerability-border);
            transition: all 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
            position: relative;
            z-index: 1;
        }

        .vulnerability-box.slide-right {
            position: fixed !important;
            top: auto !important;
            left: calc(66.666% + 20px) !important;
            right: 20px !important;
            bottom: 20px !important;
            max-height: calc(100vh - 40px) !important;
            overflow-y: auto !important;
            z-index: 2001 !important;
            margin: 0 !important;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
            transition: all 0.5s cubic-bezier(0.4, 0.0, 0.2, 1) !important;
        }

        .vulnerability-box.slide-right:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.7);
        }

        .secure-box {
            background: var(--secure-bg);
            border-left: 4px solid #22c55e;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid var(--secure-border);
            transition: all 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
            position: relative;
            z-index: 1;
        }

        .secure-box.slide-right {
            position: fixed !important;
            top: auto !important;
            left: calc(66.666% + 20px) !important;
            right: 20px !important;
            bottom: 20px !important;
            max-height: calc(100vh - 40px) !important;
            overflow-y: auto !important;
            z-index: 2001 !important;
            margin: 0 !important;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
            transition: all 0.5s cubic-bezier(0.4, 0.0, 0.2, 1) !important;
        }

        .secure-box.slide-right:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 90px rgba(0, 0, 0, 0.7);
        }



        /* Scrollbar styling for slide-right boxes */
        .vulnerability-box.slide-right,
        .secure-box.slide-right {
            scrollbar-width: thin;
            scrollbar-color: transparent transparent;
            transition: scrollbar-color 0.3s ease;
        }

        .vulnerability-box.slide-right:hover,
        .vulnerability-box.slide-right:active {
            scrollbar-color: rgba(239, 68, 68, 0.5) transparent;
        }

        .secure-box.slide-right:hover,
        .secure-box.slide-right:active {
            scrollbar-color: rgba(34, 197, 94, 0.5) transparent;
        }

        .vulnerability-box.slide-right::-webkit-scrollbar,
        .secure-box.slide-right::-webkit-scrollbar {
            width: 8px;
        }

        .vulnerability-box.slide-right::-webkit-scrollbar-track,
        .secure-box.slide-right::-webkit-scrollbar-track {
            background: transparent;
        }

        .vulnerability-box.slide-right::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .secure-box.slide-right::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .vulnerability-box.slide-right:hover::-webkit-scrollbar-thumb,
        .vulnerability-box.slide-right:active::-webkit-scrollbar-thumb {
            background: rgba(239, 68, 68, 0.5);
        }

        .secure-box.slide-right:hover::-webkit-scrollbar-thumb,
        .secure-box.slide-right:active::-webkit-scrollbar-thumb {
            background: rgba(34, 197, 94, 0.5);
        }

        .vulnerability-box.slide-right::-webkit-scrollbar-thumb:hover {
            background: rgba(239, 68, 68, 0.7);
        }

        .secure-box.slide-right::-webkit-scrollbar-thumb:hover {
            background: rgba(34, 197, 94, 0.7);
        }

        .asvs-mapping {
            background: var(--asvs-bg);
            border: 1px solid var(--asvs-border);
            padding: 25px;
            margin: 25px 0;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .asvs-mapping h4 {
            color: var(--asvs-h4);
            margin-top: 0;
            transition: color 0.3s ease;
        }

        .code-block {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 0;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.95em;
            overflow: hidden;
            max-height: 400px;
            border: var(--code-border-width) solid var(--code-border);
            box-shadow: inset 0 2px 4px var(--code-shadow);
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .code-block.expanded {
            position: fixed !important;
            top: 120px !important;
            left: 20px !important;
            width: calc(66.666% - 30px) !important;
            bottom: 20px !important;
            max-height: none !important;
            z-index: 2000;
            border-radius: 12px;
            margin: 0 !important;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
        }

        body:not(.light-theme) .code-block.expanded {
            background: #0f172a;
        }

        body.light-theme .code-block.expanded {
            background: #f8fafc;
        }

        .code-block.expanded .code-block-content {
            flex: 1;
        }

        .code-block.expanded .code-block-table {
            padding-bottom: 300px !important;
        }

        .code-expand-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--btn-bg);
            color: var(--btn-color);
            border: var(--btn-border-width) solid var(--btn-border);
            padding: 6px 12px;
            font-size: 0.85em;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            opacity: var(--btn-opacity);
            z-index: 10;
            backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            -webkit-backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .code-expand-btn:hover {
            background: var(--btn-hover-bg);
            border-color: var(--btn-hover-border);
            color: var(--btn-hover-color);
            opacity: var(--btn-hover-opacity);
            transform: scale(1.05);
            box-shadow: var(--btn-shadow);
        }

        .code-toggle-comments-btn {
            position: absolute;
            top: 8px;
            right: 50px;
            background: var(--btn-bg);
            color: var(--btn-color);
            border: var(--btn-border-width) solid var(--btn-border);
            padding: 6px 12px;
            font-size: 0.85em;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            opacity: var(--btn-opacity);
            z-index: 10;
            backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            -webkit-backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .code-toggle-comments-btn:hover {
            background: var(--btn-hover-bg);
            border-color: var(--btn-hover-border);
            color: var(--btn-hover-color);
            opacity: var(--btn-hover-opacity);
            transform: scale(1.05);
            box-shadow: var(--btn-shadow);
        }

        .code-toggle-comments-btn.comments-hidden {
            background: rgba(251, 146, 60, 0.15);
            border-color: rgba(251, 146, 60, 0.4);
            color: #fb923c;
            opacity: 1;
        }

        /* Visual indicator for annotation comments */
        .annotation-comment {
            position: relative;
        }
        
        .annotation-comment::before {
            content: '';
            position: absolute;
            left: -3px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(135deg, #fb923c 0%, #f59e0b 100%);
            opacity: 0.6;
            border-radius: 2px;
        }

        /* Timer for expanded code blocks */
        .code-timer {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(30, 41, 59, 0.95);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 16px 24px;
            z-index: 3000;
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            -webkit-backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 
                        0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            min-width: 180px;
            cursor: move;
            user-select: none;
            -webkit-user-select: none;
            transition: box-shadow 0.2s ease;
        }

        .code-timer:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5), 
                        0 0 0 1px rgba(255, 255, 255, 0.15) inset;
        }

        .code-timer.dragging {
            cursor: grabbing;
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.6), 
                        0 0 0 2px rgba(96, 165, 250, 0.5) inset;
        }

        .code-timer.visible {
            display: flex;
        }

        body.light-theme .code-timer {
            background: rgba(248, 250, 252, 0.95);
            border-color: rgba(59, 130, 246, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15), 
                        0 0 0 1px rgba(0, 0, 0, 0.05) inset;
        }

        .timer-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.5em;
            font-weight: 600;
            color: #60a5fa;
            line-height: 1;
            letter-spacing: 0.05em;
        }

        body.light-theme .timer-display {
            color: #2563eb;
        }

        .timer-display-wrapper {
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timer-input-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .timer-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .timer-input {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.5em;
            font-weight: 600;
            color: #60a5fa;
            background: rgba(59, 130, 246, 0.1);
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 8px 8px;
            padding-right: 32px;
            width: 110px;
            text-align: center;
            outline: none;
            transition: all 0.2s ease;
        }

        .timer-input:focus {
            border-color: rgba(59, 130, 246, 0.6);
            background: rgba(59, 130, 246, 0.15);
        }

        /* Hide default spinner buttons - we'll use custom styled ones */
        .timer-input::-webkit-inner-spin-button,
        .timer-input::-webkit-outer-spin-button {
            -webkit-appearance: none;
            appearance: none;
            margin: 0;
        }

        /* Firefox number input */
        .timer-input[type=number] {
            -moz-appearance: textfield;
            appearance: textfield;
        }

        .timer-spinner-buttons {
            position: absolute;
            right: 3px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            background: transparent;
            border: none;
            padding: 2px;
            opacity: 0.7;
            transition: all 0.15s ease;
        }

        .timer-spinner-buttons:hover {
            opacity: 1;
        }

        .timer-spinner-btn {
            width: 24px;
            height: 18px;
            background: transparent;
            border: none;
            color: rgba(96, 165, 250, 0.6);
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
            padding: 0;
            line-height: 1;
        }

        .timer-spinner-btn:hover {
            color: rgba(96, 165, 250, 0.9);
        }

        .timer-spinner-btn:active {
            color: rgba(96, 165, 250, 1);
            transform: scale(0.95);
        }

        body.light-theme .timer-input {
            color: #2563eb;
            background: rgba(59, 130, 246, 0.05);
            border-color: rgba(59, 130, 246, 0.3);
        }

        body.light-theme .timer-spinner-buttons {
            opacity: 0.7;
        }

        body.light-theme .timer-spinner-buttons:hover {
            opacity: 1;
        }

        body.light-theme .timer-spinner-btn {
            color: rgba(37, 99, 235, 0.6);
        }

        body.light-theme .timer-spinner-btn:hover {
            color: rgba(37, 99, 235, 0.9);
        }

        body.light-theme .timer-spinner-btn:active {
            color: rgba(37, 99, 235, 1);
        }

        body.light-theme .timer-input:focus {
            border-color: rgba(59, 130, 246, 0.5);
            background: rgba(59, 130, 246, 0.1);
        }

        .timer-separator {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2.5em;
            font-weight: 600;
            color: #60a5fa;
            line-height: 1;
        }

        body.light-theme .timer-separator {
            color: #2563eb;
        }

        .timer-controls {
            display: flex;
            gap: 8px;
            margin-top: 4px;
        }

        .timer-btn {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.4);
            color: #60a5fa;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75em;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .timer-btn:hover {
            background: rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.6);
            transform: scale(1.05);
        }

        body.light-theme .timer-btn {
            background: rgba(59, 130, 246, 0.15);
            border-color: rgba(59, 130, 246, 0.3);
            color: #2563eb;
        }

        body.light-theme .timer-btn:hover {
            background: rgba(59, 130, 246, 0.25);
            border-color: rgba(59, 130, 246, 0.5);
        }

        .timer-label {
            font-size: 0.7em;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 500;
        }

        body.light-theme .timer-label {
            color: #64748b;
        }

        /* Obfuscation mask for annotation comments - Dark theme */
        .annotation-comment::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    45deg,
                    rgba(96, 165, 250, 0.15) 0px,
                    rgba(96, 165, 250, 0.15) 3px,
                    rgba(139, 92, 246, 0.15) 3px,
                    rgba(139, 92, 246, 0.15) 6px
                ),
                linear-gradient(
                    90deg,
                    rgba(15, 23, 42, 0.98) 0%,
                    rgba(30, 41, 59, 0.98) 50%,
                    rgba(15, 23, 42, 0.98) 100%
                );
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1), left 0.6s cubic-bezier(0.4, 0, 0.2, 1), width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-radius: 4px;
            z-index: 1;
        }

        /* Use measured width for precise masking */
        .annotation-comment.has-measured-mask::after {
            left: var(--mask-left, 0);
            width: var(--mask-width, 100%);
            right: auto;
        }

        /* Obfuscation mask for annotation comments - Light theme */
        body.light-theme .annotation-comment::after {
            background: 
                repeating-linear-gradient(
                    45deg,
                    rgba(96, 165, 250, 0.2) 0px,
                    rgba(96, 165, 250, 0.2) 3px,
                    rgba(139, 92, 246, 0.2) 3px,
                    rgba(139, 92, 246, 0.2) 6px
                ),
                linear-gradient(
                    90deg,
                    rgba(248, 250, 252, 0.98) 0%,
                    rgba(241, 245, 249, 0.98) 50%,
                    rgba(248, 250, 252, 0.98) 100%
                );
        }

        /* Show mask when annotations are hidden (global toggle) */
        .code-block.hide-annotations .annotation-comment::after {
            opacity: 1;
            animation: shimmer 3s ease-in-out infinite, slideIn 0.6s ease-out;
        }

        /* Show mask on individual annotation lines (individual toggle) */
        .annotation-comment.mask-hidden::after {
            opacity: 1;
            animation: shimmer 3s ease-in-out infinite, slideIn 0.6s ease-out;
        }

        /* IMPORTANT: Individual reveal overrides global hide - higher specificity */
        .code-block.hide-annotations .annotation-comment:not(.mask-hidden)::after {
            opacity: 0 !important;
            animation: none;
        }

        /* Ensure text is not selectable when individually masked */
        .annotation-comment.mask-hidden {
            user-select: none;
            -webkit-user-select: none;
        }

        /* Individual reveal overrides global hide for text selection */
        .code-block.hide-annotations .annotation-comment:not(.mask-hidden) {
            user-select: text;
            -webkit-user-select: text;
        }

        /* Additional visual effect - blur the actual text slightly when individually masked */
        .annotation-comment.mask-hidden .comment {
            filter: blur(3px);
            transition: filter 0.5s ease;
        }

        /* Individual reveal overrides global hide for blur effect */
        .code-block.hide-annotations .annotation-comment:not(.mask-hidden) .comment {
            filter: blur(0);
        }

        /* Shimmer animation for masked comments */
        @keyframes shimmer {
            0%, 100% {
                background-position: 0% 50%;
                filter: brightness(1);
            }
            50% {
                background-position: 100% 50%;
                filter: brightness(1.15);
            }
        }

        /* Slide in animation when mask appears */
        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateX(-10px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Ensure text is not selectable when masked */
        .code-block.hide-annotations .annotation-comment {
            user-select: none;
            -webkit-user-select: none;
        }

        /* Additional visual effect - blur the actual text slightly when masked */
        .code-block.hide-annotations .annotation-comment .comment {
            filter: blur(3px);
            transition: filter 0.5s ease;
        }

        .annotation-comment .comment {
            transition: filter 0.5s ease;
        }

        .code-block-content {
            overflow: auto;
            flex: 1;
            scrollbar-width: thin;
            scrollbar-color: transparent transparent;
            padding-top: 10px;
            transition: scrollbar-color 0.3s ease;
            min-height: 0;
            min-width: 0;
        }

        .code-block-content:hover,
        .code-block-content:active,
        .code-block-content:focus-within,
        .code-block-content:is(:hover, :active, :focus-within) {
            scrollbar-color: var(--line-number-border) transparent;
        }

        .code-block-content::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .code-block-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .code-block-content::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .code-block-content:hover::-webkit-scrollbar-thumb,
        .code-block-content:active::-webkit-scrollbar-thumb,
        .code-block-content:focus-within::-webkit-scrollbar-thumb,
        .code-block-content:is(:hover, :active, :focus-within)::-webkit-scrollbar-thumb {
            background: var(--line-number-border);
        }

        .code-block-content::-webkit-scrollbar-thumb:hover {
            background: var(--h2-color);
        }

        .code-block-content::-webkit-scrollbar-corner {
            background: transparent;
        }

        /* Ensure horizontal scrollbar is always enabled when needed */
        .code-block-content::-webkit-scrollbar-horizontal {
            height: 8px;
        }

        .code-block-table {
            display: table;
            min-width: 100%;
            width: max-content;
            border-collapse: collapse;
            padding: 25px 0 200px 0;
        }

        .code-block-row {
            display: table-row;
        }

        .code-block-row:hover .code-line {
            background: var(--code-line-hover-bg);
        }

        .code-block-row:hover .code-line-number {
            background: var(--line-number-hover-bg);
        }

        .code-block-row.selected .code-line {
            background: var(--code-line-selected-bg);
        }

        .code-block-row.selected .code-line-number {
            background: var(--line-number-selected-bg);
            color: var(--h2-color);
            font-weight: 600;
        }

        .code-line-number {
            display: table-cell;
            background: var(--line-number-bg);
            color: var(--line-number-color);
            padding: 0 15px;
            text-align: right;
            user-select: none;
            min-width: 50px;
            width: 50px;
            border-right: 1px solid var(--line-number-border);
            font-size: 0.9em;
            line-height: 1.6;
            cursor: pointer;
            vertical-align: top;
            position: sticky;
            left: 0;
            z-index: 1;
        }

        .code-line {
            display: table-cell;
            padding: 0 25px;
            white-space: pre;
            line-height: 1.6;
            cursor: text;
            vertical-align: top;
        }

        .comment {
            color: var(--comment-color);
            transition: color 0.3s ease;
        }

        .keyword {
            color: var(--keyword-color);
            transition: color 0.3s ease;
        }

        .string {
            color: var(--string-color);
            transition: color 0.3s ease;
        }

        .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }

        button {
            background: var(--btn-bg);
            color: var(--btn-color);
            border: var(--btn-border-width) solid var(--btn-border);
            padding: 10px 20px;
            font-size: 0.95em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            opacity: var(--btn-opacity);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08), 
                        inset 0 1px 0 rgba(255, 255, 255, 0.2),
                        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            -webkit-backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
        }

        .nav-btn {
            width: 44px;
            height: 44px;
            padding: 0;
            font-size: 1.3em;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn:hover {
            background: var(--btn-hover-bg);
            border-color: var(--btn-hover-border);
            color: var(--btn-hover-color);
            opacity: var(--btn-hover-opacity);
            transform: translateY(-2px);
            box-shadow: var(--btn-shadow);
        }

        .btn:disabled {
            opacity: var(--btn-disabled-opacity);
            cursor: not-allowed;
            background: var(--btn-disabled-bg);
        }

        .btn:disabled:hover {
            transform: none;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            background: var(--btn-disabled-bg);
            opacity: var(--btn-disabled-opacity);
        }

        .slide-number {
            position: fixed;
            bottom: 20px;
            left: 20px;
            color: var(--btn-color);
            font-size: 0.8em;
            font-weight: 500;
            background: var(--btn-bg);
            padding: 8px 14px;
            border-radius: 8px;
            border: var(--btn-border-width) solid var(--btn-border);
            backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            -webkit-backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
            opacity: var(--btn-opacity);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08), 
                        inset 0 1px 0 rgba(255, 255, 255, 0.2),
                        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
        }

        .slide-number:hover {
            background: var(--btn-hover-bg);
            border-color: var(--btn-hover-border);
            color: var(--btn-hover-color);
            opacity: var(--btn-hover-opacity);
            transform: translateY(-2px);
            box-shadow: var(--btn-shadow);
        }

        .slide-selector {
            position: fixed;
            bottom: 60px;
            left: 20px;
            background: var(--selector-bg);
            backdrop-filter: blur(40px) saturate(200%) brightness(1.1);
            -webkit-backdrop-filter: blur(40px) saturate(200%) brightness(1.1);
            border-radius: 12px;
            border: var(--selector-border-width) solid var(--selector-border);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.05);
            max-height: 400px;
            display: none;
            z-index: 1001;
            min-width: 260px;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        #slideSelectorList {
            max-height: 348px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: transparent transparent;
            transition: scrollbar-color 0.3s ease;
        }

        #slideSelectorList:hover,
        #slideSelectorList:active {
            scrollbar-color: var(--line-number-border) transparent;
        }

        #slideSelectorList::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        #slideSelectorList::-webkit-scrollbar-track {
            background: transparent;
        }

        #slideSelectorList::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        #slideSelectorList:hover::-webkit-scrollbar-thumb,
        #slideSelectorList:active::-webkit-scrollbar-thumb {
            background: var(--line-number-border);
        }

        #slideSelectorList::-webkit-scrollbar-thumb:hover {
            background: var(--h2-color);
        }

        #slideSelectorList::-webkit-scrollbar-corner {
            background: transparent;
        }

        .slide-selector.active {
            display: block;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-selector-item {
            padding: 10px 16px;
            border-bottom: 1px solid rgba(59, 130, 246, 0.1);
            cursor: pointer;
            transition: all 0.2s;
            color: var(--selector-item-color);
            font-size: 0.85em;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .slide-selector-item:hover {
            background: var(--selector-item-hover-bg);
            color: var(--selector-item-hover-color);
        }

        .slide-selector-item.current {
            background: var(--selector-item-current-bg);
            color: var(--selector-item-current-color);
            font-weight: 600;
            border-left: 3px solid var(--selector-item-current-border);
        }

        .slide-selector-item:last-child {
            border-bottom: none;
        }

        .slide-number-badge {
            min-width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        /* Dark theme badge */
        body:not(.light-theme) .slide-number-badge {
            background: rgba(59, 130, 246, 0.15);
            color: #60a5fa;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        /* Light theme badge */
        body.light-theme .slide-number-badge {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border: 1px solid rgba(59, 130, 246, 0.25);
        }

        /* Dark theme hover */
        body:not(.light-theme) .slide-selector-item:hover .slide-number-badge {
            background: rgba(59, 130, 246, 0.25);
            color: #93c5fd;
            border-color: rgba(59, 130, 246, 0.5);
            transform: scale(1.05);
        }

        /* Light theme hover */
        body.light-theme .slide-selector-item:hover .slide-number-badge {
            background: rgba(59, 130, 246, 0.2);
            color: #2563eb;
            border-color: rgba(59, 130, 246, 0.4);
            transform: scale(1.05);
        }

        /* Dark theme current slide */
        body:not(.light-theme) .slide-selector-item.current .slide-number-badge {
            background: rgba(59, 130, 246, 0.3);
            color: #93c5fd;
            border-color: rgba(59, 130, 246, 0.6);
            box-shadow: 0 0 12px rgba(59, 130, 246, 0.4);
        }

        /* Light theme current slide */
        body.light-theme .slide-selector-item.current .slide-number-badge {
            background: #3b82f6;
            color: #ffffff;
            border-color: #3b82f6;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        .slide-selector-header {
            padding: 12px 16px;
            background: var(--selector-header-bg);
            color: var(--selector-header-color);
            font-weight: 600;
            font-size: 0.85em;
            border-radius: 10px 10px 0 0;
            backdrop-filter: blur(10px);
            border-bottom: var(--selector-border-width) solid var(--selector-header-border);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
        }

        .slide-jump-input {
            width: 60px;
            padding: 6px 10px;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid var(--selector-header-border);
            border-radius: 6px;
            color: var(--selector-header-color);
            font-size: 0.9em;
            font-weight: 600;
            text-align: center;
            transition: all 0.2s ease;
            outline: none;
        }

        body.light-theme .slide-jump-input {
            background: rgba(248, 250, 252, 0.8);
            color: #3b82f6;
        }

        .slide-jump-input:hover {
            border-color: var(--selector-item-current-border);
            background: rgba(59, 130, 246, 0.1);
        }

        .slide-jump-input:focus {
            border-color: var(--selector-item-current-border);
            background: rgba(59, 130, 246, 0.15);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Remove spinner arrows in Chrome, Safari, Edge */
        .slide-jump-input::-webkit-outer-spin-button,
        .slide-jump-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Remove spinner arrows in Firefox */
        .slide-jump-input[type=number] {
            -moz-appearance: textfield;
        }

        /* Shake animation for invalid input - subtle version */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25%, 75% { transform: translateX(-3px); }
            50% { transform: translateX(3px); }
        }

        .slide-jump-input.shake {
            animation: shake 0.3s ease-in-out;
            border-color: #ef4444;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 10px;
            border: var(--card-border-width) solid var(--card-border);
            backdrop-filter: blur(10px);
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }

        .card h3,
        .card h4 {
            color: var(--card-h-color);
            transition: color 0.3s ease;
        }

        .card p,
        .card li {
            color: var(--card-text);
            transition: color 0.3s ease;
        }

        .badge {
            display: inline-block;
            background: var(--badge-bg);
            color: var(--badge-color);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-right: 10px;
            margin-bottom: 10px;
            border: 1px solid var(--badge-border);
            transition: all 0.3s ease;
        }

        .badge-danger {
            background: var(--badge-danger-bg);
            color: var(--badge-danger-color);
            border: 1px solid var(--badge-danger-border);
        }

        .badge-success {
            background: var(--badge-success-bg);
            color: var(--badge-success-color);
            border: 1px solid var(--badge-success-border);
        }

        .badge-warning {
            background: var(--badge-warning-bg);
            color: var(--badge-warning-color);
            border: 1px solid var(--badge-warning-border);
        }

        .highlight-box {
            background: var(--highlight-bg);
            border: 2px dashed var(--highlight-border);
            padding: 30px;
            border-radius: 10px;
            margin: 25px 0;
            text-align: center;
            transition: all 0.3s ease;
        }

        .highlight-box p,
        .highlight-box strong {
            color: var(--highlight-text);
            transition: color 0.3s ease;
        }

        .checklist {
            list-style: none;
            margin-left: 0;
        }

        .checklist li:before {
            content: "✓ ";
            color: var(--checklist-check);
            font-weight: bold;
            font-size: 1.4em;
            margin-right: 10px;
            transition: color 0.3s ease;
        }

        .timeline {
            background: var(--timeline-bg);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: var(--timeline-border-width) solid var(--timeline-border);
            transition: all 0.3s ease;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }

        .timeline-item div {
            color: var(--timeline-text);
            transition: color 0.3s ease;
        }

        .timeline-time {
            background: var(--timeline-time-bg);
            color: var(--timeline-time-color);
            padding: 8px 16px;
            border-radius: 20px;
            min-width: 80px;
            text-align: center;
            font-weight: bold;
            margin-right: 20px;
            border: 1px solid var(--timeline-time-border);
            transition: all 0.3s ease;
        }

        .key-point {
            background: var(--key-point-bg);
            color: var(--key-point-color);
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            font-size: 1.3em;
            text-align: center;
            font-weight: bold;
            border: var(--key-point-border-width) solid var(--key-point-border);
            box-shadow: var(--key-point-shadow);
            transition: all 0.3s ease;
        }

        .emoji {
            font-size: 2em;
            margin-right: 15px;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 25px 0;
        }

        .comparison-bad {
            background: var(--comparison-bad-bg);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--comparison-bad-border);
            transition: all 0.3s ease;
        }

        .comparison-good {
            background: var(--comparison-good-bg);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--comparison-good-border);
            transition: all 0.3s ease;
        }

        .comparison h4 {
            margin-top: 0;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            color: var(--scroll-indicator);
            font-size: 0.9em;
            font-style: italic;
            transition: color 0.3s ease;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 44px;
            height: 44px;
            background: var(--btn-bg);
            color: var(--btn-color);
            border: var(--btn-border-width) solid var(--btn-border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            opacity: var(--btn-opacity);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08), 
                        inset 0 1px 0 rgba(255, 255, 255, 0.2),
                        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            -webkit-backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
        }

        .theme-toggle #themeIcon {
            filter: grayscale(1);
            transition: filter 0.3s ease;
        }

        .theme-toggle:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
            background: var(--btn-hover-bg);
            border-color: var(--btn-hover-border);
            color: var(--btn-hover-color);
            opacity: var(--btn-hover-opacity);
        }

        .theme-toggle:hover #themeIcon {
            filter: grayscale(0);
        }

        .theme-toggle:active {
            transform: translateY(0) scale(0.95);
        }

        .timer-toggle {
            position: fixed;
            top: 20px;
            right: 74px;
            width: 44px;
            height: 44px;
            background: var(--btn-bg);
            color: var(--btn-color);
            border: var(--btn-border-width) solid var(--btn-border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            opacity: var(--btn-opacity);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08), 
                        inset 0 1px 0 rgba(255, 255, 255, 0.2),
                        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
            backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
            -webkit-backdrop-filter: blur(32px) saturate(200%) brightness(1.1);
        }

        .timer-toggle.active {
            background: rgba(96, 165, 250, 0.2);
            border-color: rgba(96, 165, 250, 0.5);
            color: #60a5fa;
        }

        body.light-theme .timer-toggle.active {
            background: rgba(37, 99, 235, 0.15);
            border-color: rgba(37, 99, 235, 0.4);
            color: #2563eb;
        }

        .timer-toggle:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
            background: var(--btn-hover-bg);
            border-color: var(--btn-hover-border);
            color: var(--btn-hover-color);
            opacity: var(--btn-hover-opacity);
        }

        .timer-toggle:active {
            transform: translateY(0) scale(0.95);
        }

        .owasp-branding {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 1001;
            transition: all 0.3s ease;
        }

        .owasp-branding:hover {
            transform: translateY(-2px);
        }

        .workshop-title {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.95em;
            font-weight: 600;
            color: var(--btn-color);
            z-index: 1001;
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .agenda-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .agenda-item:hover {
            transform: translateX(8px) scale(1.02);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .agenda-item:hover .agenda-icon {
            transform: scale(1.15) rotate(5deg);
        }

        .agenda-icon {
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .chapter-card {
            cursor: pointer;
        }

        .chapter-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.2);
        }

        .chapter-card:hover .badge {
            transform: scale(1.15) rotate(-5deg);
        }

        .chapter-card .badge {
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .hover-lift:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.2);
        }

        .owasp-branding img {
            height: 28px;
            transition: filter 0.3s ease;
        }

        body:not(.light-theme) .owasp-branding img {
            filter: brightness(0) invert(1) opacity(0.9);
        }

        body.light-theme .owasp-branding img {
            filter: opacity(0.85);
        }

        .owasp-branding-text {
            font-size: 0.9em;
            font-weight: 600;
            color: var(--btn-color);
            white-space: nowrap;
            transition: color 0.3s ease;
        }

        .theme-icon {
            font-size: 1.2em;
        }

        .asvs-badge {
            position: absolute;
            background: var(--badge-float-bg);
            padding: 10px 16px;
            border-radius: 6px;
            font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.7em;
            backdrop-filter: blur(12px);
            box-shadow: 0 4px 12px var(--badge-float-shadow);
            transition: all 0.3s ease;
        }

        .asvs-badge-blue {
            border: 2px solid rgba(59, 130, 246, 0.3);
            color: var(--badge-color);
        }

        .asvs-badge-purple {
            border: 2px solid rgba(139, 92, 246, 0.3);
            color: var(--h3-color);
        }

        .asvs-badge-green {
            border: 2px solid rgba(34, 197, 94, 0.3);
            color: var(--badge-success-color);
        }

        .asvs-badge-orange {
            border: 2px solid rgba(251, 146, 60, 0.3);
            color: var(--badge-warning-color);
        }

        .asvs-badge-pink {
            border: 2px solid rgba(236, 72, 153, 0.3);
            color: var(--badge-danger-color);
        }

        .owasp-logo {
            height: 80px;
            transition: filter 0.3s ease;
        }

        body:not(.light-theme) .owasp-logo {
            filter: brightness(0) invert(1) opacity(0.9);
        }

        body.light-theme .owasp-logo {
            filter: opacity(0.85);
        }

        .speaker-badge {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            text-align: center;
            width: 120px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .speaker-badge-linkedin {
            border: 2px solid rgba(10, 102, 194, 0.4);
        }

        .speaker-badge-ceh {
            border: 2px solid rgba(239, 68, 68, 0.3);
        }

        .prof-background-box {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            border: var(--card-border-width) solid var(--card-border);
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }

        .prof-title {
            font-weight: 600;
            color: var(--card-text);
            font-size: 1.15em;
            margin-bottom: 5px;
            transition: color 0.3s ease;
        }

        .prof-subtitle {
            color: var(--subtitle-color);
            font-size: 1em;
            transition: color 0.3s ease;
        }

        .quote-box {
            background: var(--user-story-bg);
            padding: 20px 25px;
            border-radius: 12px;
            border-left: 4px solid var(--h2-color);
            font-style: italic;
            color: var(--user-story-text);
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .card-title {
            color: var(--card-text);
            transition: color 0.3s ease;
        }

        .api-endpoint-box {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0;
            font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace;
            border: var(--card-border-width) solid var(--card-border);
            transition: all 0.3s ease;
        }

        .api-endpoint-label {
            color: var(--card-h-color);
            transition: color 0.3s ease;
        }

        .api-endpoint-text {
            color: var(--card-text);
            transition: color 0.3s ease;
        }

        .scavenger-scenario {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid var(--h2-color);
            margin: 25px 0;
            transition: all 0.3s ease;
        }

        .scavenger-scenario h4 {
            color: var(--card-h-color);
            margin-top: 0;
            transition: color 0.3s ease;
        }

        .scavenger-scenario p {
            color: var(--card-text);
            transition: color 0.3s ease;
        }

        .scavenger-task {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            border: var(--card-border-width) solid var(--card-border);
            transition: all 0.3s ease;
        }

        .scavenger-task strong {
            color: var(--card-h-color);
            transition: color 0.3s ease;
        }

        .scavenger-task p {
            color: var(--card-text);
            margin: 10px 0 0 0;
            transition: color 0.3s ease;
        }

        .highlight-title {
            color: var(--highlight-title-color);
            transition: color 0.3s ease;
        }

        .app-overview-box {
            background: var(--card-bg);
            padding: 35px;
            border-radius: 15px;
            border: var(--card-border-width) solid var(--card-border);
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }

        .app-overview-box h3 {
            color: var(--card-h-color);
            transition: color 0.3s ease;
        }

        .app-overview-box p {
            color: var(--card-text);
            transition: color 0.3s ease;
        }

        .contact-box {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            border: var(--card-border-width) solid var(--card-border);
            transition: all 0.3s ease;
        }

        .contact-box h3 {
            color: var(--card-h-color);
            margin-top: 0;
            transition: color 0.3s ease;
        }

        .contact-box p {
            color: var(--card-text);
            transition: color 0.3s ease;
        }

        .checklist-box {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 15px;
            margin-top: 30px;
            border: var(--card-border-width) solid var(--card-border);
            transition: all 0.3s ease;
        }

        .checklist-box .checklist {
            color: var(--card-text);
            transition: color 0.3s ease;
        }

        .resources-card {
            background: var(--resources-card-bg);
            color: var(--resources-card-text);
            padding: 30px;
            margin: 30px 0;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .resources-card h3 {
            color: var(--resources-card-text);
            margin-top: 0;
            transition: color 0.3s ease;
        }

        .resources-card a {
            color: var(--resources-link-color);
            text-decoration: none;
            font-weight: 600;
            background: linear-gradient(to right, var(--resources-link-color), var(--resources-link-hover));
            background-size: 0% 2px;
            background-repeat: no-repeat;
            background-position: left bottom;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-block;
            position: relative;
        }

        .resources-card a::after {
            content: '→';
            margin-left: 8px;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.3s ease;
        }

        .resources-card a:hover {
            color: var(--resources-link-hover);
            background-size: 100% 2px;
            transform: translateX(5px);
        }

        .resources-card a:hover::after {
            opacity: 1;
            transform: translateX(0);
        }

        .resource-link-item {
            background: var(--card-bg);
            border: var(--card-border-width) solid var(--card-border);
            border-radius: 10px;
            padding: 18px 25px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            display: block;
        }

        .resource-link-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(180deg, #60a5fa, #a78bfa);
            transform: scaleY(0);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .resource-link-item:hover {
            transform: translateX(5px);
            border-color: rgba(59, 130, 246, 0.4);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.12);
        }

        .resource-link-item:hover::before {
            transform: scaleY(1);
        }

        .resource-icon-small {
            font-size: 2em;
            line-height: 1;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .resource-link-item:hover .resource-icon-small {
            transform: scale(1.15);
        }

        .resource-url {
            font-size: 0.9em;
            color: var(--h2-color);
            opacity: 0.75;
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }

        .resource-arrow-small {
            font-size: 1.5em;
            color: var(--h2-color);
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .resource-link-item:hover .resource-arrow-small {
            opacity: 1;
            transform: translateX(0);
        }

        .remember-section {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 20px;
            max-width: 800px;
            border: var(--card-border-width) solid var(--card-border);
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }

        .remember-section h3 {
            color: var(--card-h-color);
            margin-bottom: 25px;
            font-size: 1.8em;
            transition: color 0.3s ease;
        }

        .remember-section p {
            color: var(--card-text);
            transition: color 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- OWASP Cebu Chapter Branding -->
    <div class="owasp-branding">
        <img src="https://owasp.org/assets/images/logo.png" alt="OWASP">
        <span class="owasp-branding-text">Cebu Chapter</span>
    </div>

    <!-- Workshop Title -->
    <div class="workshop-title">FORTIFY: Secure Development Fundamentals</div>

    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()" title="Toggle Theme">
        <span id="themeIcon">☀️</span>
    </button>

    <!-- Timer Toggle Button -->
    <button class="timer-toggle" id="timerToggle" onclick="toggleTimerVisibility()" title="Toggle Timer">
        ⏱️
    </button>

    <!-- Timer for expanded code blocks -->
    <div class="code-timer" id="codeTimer">
        <div class="timer-label">Timer</div>
        <div class="timer-display-wrapper">
            <div class="timer-display" id="timerDisplay">00:00</div>
            <div class="timer-input-group" id="timerInputGroup" style="display: none;">
                <div class="timer-input-wrapper">
                    <input type="number" id="timerMinutes" class="timer-input" min="0" max="99" step="1" value="5" placeholder="MM" oninput="validateTimerInput(this, 99)">
                    <div class="timer-spinner-buttons">
                        <button class="timer-spinner-btn timer-spinner-up" onclick="incrementMinutes(event)" title="Increase">▲</button>
                        <button class="timer-spinner-btn timer-spinner-down" onclick="decrementMinutes(event)" title="Decrease">▼</button>
                    </div>
                </div>
                <span class="timer-separator">:</span>
                <div class="timer-input-wrapper">
                    <input type="number" id="timerSeconds" class="timer-input" min="0" max="59" step="1" value="0" placeholder="SS" oninput="validateTimerInput(this, 59)">
                    <div class="timer-spinner-buttons">
                        <button class="timer-spinner-btn timer-spinner-up" onclick="incrementSeconds(event)" title="Increase">▲</button>
                        <button class="timer-spinner-btn timer-spinner-down" onclick="decrementSeconds(event)" title="Decrease">▼</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="timer-controls">
            <button class="timer-btn" id="timerSet" onclick="toggleTimerInput()">Set</button>
            <button class="timer-btn" id="timerStart" onclick="startTimer()">Start</button>
            <button class="timer-btn" id="timerReset" onclick="resetTimer()">Reset</button>
        </div>
    </div>

    <div class="presentation">
        <!-- Slide 1: Title -->
        <div class="slide active">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 60px; align-items: center; height: 100%; padding: 0 80px;">
                <!-- Left side: Content -->
                <div style="text-align: left;">
                    <!-- OWASP Logo -->
                    <div style="margin-bottom: 40px;">
                        <img src="https://owasp.org/assets/images/logo.png" alt="OWASP Logo" class="owasp-logo">
                    </div>
                    
                    <h1 style="font-size: 3.5em; margin-bottom: 20px; line-height: 1.2; background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        ASVS v5.0
                    </h1>
                    
                    <p style="font-size: 1.8em; color: #8d949c; margin-bottom: 30px; font-weight: 300;">
                        Application Security<br>Verification Standard
                    </p>
                    
                    <div style="height: 3px; width: 120px; background: linear-gradient(90deg, #60a5fa, transparent); margin: 30px 0;"></div>
                    
                    <p style="font-size: 1.3em; color: #94a3b8; line-height: 1.6; margin-bottom: 40px;">
                        Building Secure Applications<br>from User Stories
                    </p>
                    
                    <div style="display: flex; gap: 20px; align-items: center;">
                        <span style="background: rgba(59, 130, 246, 0.2); color: #60a5fa; padding: 12px 24px; border-radius: 8px; font-size: 1em; border: 1px solid rgba(59, 130, 246, 0.3);">
                            🎯 Interactive Workshop
                        </span>
                    </div>
                </div>
                
                <!-- Right side: Security Visual -->
                <div style="position: relative; height: 600px; display: flex; align-items: center; justify-content: center;">
                    <!-- Decorative security shield with code -->
                    <div style="position: relative; width: 500px; height: 600px;">
                        <!-- Background glow -->
                        <div style="position: absolute; inset: 0; background: radial-gradient(circle, rgba(59, 130, 246, 0.2) 0%, transparent 70%); filter: blur(40px);"></div>
                        
                        <!-- Shield icon using SVG-like styling -->
                        <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center;">
                            <div style="font-size: 200px; opacity: 0.12; filter: drop-shadow(0 0 30px rgba(59, 130, 246, 0.5));">
                                🛡️
                            </div>
                        </div>
                        
                        <!-- Floating ASVS Chapter Badges - All 17 Chapters -->
                        <!-- Row 1 - Top -->
                        <div class="asvs-badge asvs-badge-blue" style="top: 10px; left: 30px; animation: float1 3.2s ease-in-out infinite;">
                            V1: Encoding ✓
                        </div>
                        <div class="asvs-badge asvs-badge-purple" style="top: 5px; left: 160px; animation: float2 3.5s ease-in-out infinite;">
                            V2: Validation ✓
                        </div>
                        <div class="asvs-badge asvs-badge-green" style="top: 15px; left: 290px; animation: float3 3.8s ease-in-out infinite;">
                            V3: Frontend ✓
                        </div>
                        <div class="asvs-badge asvs-badge-orange" style="top: 20px; right: 30px; animation: float4 3.3s ease-in-out infinite;">
                            V4: API ✓
                        </div>
                        
                        <!-- Row 2 - Upper Middle -->
                        <div class="asvs-badge asvs-badge-pink" style="top: 100px; left: 10px; animation: float5 3.6s ease-in-out infinite;">
                            V5: Files ✓
                        </div>
                        <div class="asvs-badge asvs-badge-blue" style="top: 90px; left: 120px; animation: float6 3.9s ease-in-out infinite;">
                            V6: AuthN ✓
                        </div>
                        <div class="asvs-badge asvs-badge-purple" style="top: 95px; right: 100px; animation: float7 3.4s ease-in-out infinite;">
                            V7: Session ✓
                        </div>
                        <div class="asvs-badge asvs-badge-green" style="top: 105px; right: 10px; animation: float8 3.7s ease-in-out infinite;">
                            V8: AuthZ ✓
                        </div>
                        
                        <!-- Row 3 - Center -->
                        <div class="asvs-badge asvs-badge-orange" style="top: 200px; left: 5px; animation: float9 3.3s ease-in-out infinite;">
                            V9: Tokens ✓
                        </div>
                        <div class="asvs-badge asvs-badge-blue" style="top: 190px; left: 120px; animation: float10 3.8s ease-in-out infinite;">
                            V10: OAuth ✓
                        </div>
                        <div class="asvs-badge asvs-badge-green" style="top: 195px; right: 90px; animation: float11 3.5s ease-in-out infinite;">
                            V11: Crypto ✓
                        </div>
                        <div class="asvs-badge asvs-badge-purple" style="top: 205px; right: 0px; animation: float12 3.6s ease-in-out infinite;">
                            V12: Comms ✓
                        </div>
                        
                        <!-- Row 4 - Lower Middle -->
                        <div class="asvs-badge asvs-badge-pink" style="bottom: 180px; left: 20px; animation: float13 3.4s ease-in-out infinite;">
                            V13: Config ✓
                        </div>
                        <div class="asvs-badge asvs-badge-blue" style="bottom: 175px; left: 140px; animation: float14 3.7s ease-in-out infinite;">
                            V14: Data ✓
                        </div>
                        <div class="asvs-badge asvs-badge-green" style="bottom: 170px; right: 80px; animation: float15 3.9s ease-in-out infinite;">
                            V15: Coding ✓
                        </div>
                        
                        <!-- Row 5 - Bottom -->
                        <div class="asvs-badge asvs-badge-orange" style="bottom: 80px; left: 60px; animation: float16 3.5s ease-in-out infinite;">
                            V16: Logging ✓
                        </div>
                        <div class="asvs-badge asvs-badge-purple" style="bottom: 85px; left: 180px; animation: float17 3.3s ease-in-out infinite;">
                            V17: WebRTC ✓
                        </div>
                        
                        <!-- Lock icon overlay -->
                        <div style="position: absolute; bottom: 20px; right: 60px; font-size: 50px; opacity: 0.25; animation: pulse 2s ease-in-out infinite;">
                            🔒
                        </div>
                    </div>
                </div>
            </div>
            
            <style>
                @keyframes float1 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-12px); }
                }
                @keyframes float2 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-8px); }
                }
                @keyframes float3 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-15px); }
                }
                @keyframes float4 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-10px); }
                }
                @keyframes float5 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-14px); }
                }
                @keyframes float6 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-9px); }
                }
                @keyframes float7 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-11px); }
                }
                @keyframes float8 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-13px); }
                }
                @keyframes float9 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-10px); }
                }
                @keyframes float10 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-12px); }
                }
                @keyframes float11 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-8px); }
                }
                @keyframes float12 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-14px); }
                }
                @keyframes float13 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-11px); }
                }
                @keyframes float14 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-13px); }
                }
                @keyframes float15 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-9px); }
                }
                @keyframes float16 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-12px); }
                }
                @keyframes float17 {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-10px); }
                }
                
                @keyframes pulse {
                    0%, 100% { opacity: 0.25; transform: scale(1); }
                    50% { opacity: 0.4; transform: scale(1.05); }
                }
            </style>
        </div>

        <!-- Slide 2: Speaker Introduction -->
        <div class="slide">
            <h2 style="margin-bottom: 50px;">👨‍💻 Your Speaker</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 60px; align-items: start; padding: 0 60px;">
                <!-- Left Column: Photo and Badges -->
                <div style="display: flex; flex-direction: column; gap: 30px; align-items: center;">
                    <!-- Speaker Photo -->
                    <div style="position: relative;">
                        <img src="./assets/speaker.jpeg" alt="Speaker" style="width: 420px; height: 420px; border-radius: 20px; object-fit: cover; border: 3px solid rgba(59, 130, 246, 0.5); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);">
                        <div style="position: absolute; bottom: -15px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); padding: 8px 20px; border-radius: 20px; font-size: 1.2em; font-weight: 600; white-space: nowrap; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);">
                            Ahdzleebee Formentera
                        </div>
                    </div>
                    
                    <!-- Badges Row -->
                    <div style="display: flex; gap: 20px; margin-top: 20px;">
                        <!-- LinkedIn Profile Link -->
                        <a href="https://www.linkedin.com/in/ahdzlee" target="_blank" style="display: block; text-decoration: none; transition: transform 0.3s ease; border-bottom: none;" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
                            <div class="speaker-badge speaker-badge-linkedin">
                                <div style="width: 90px; height: 90px; background: #0A66C2; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 8px;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="white">
                                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                    </svg>
                                </div>
                                <div style="font-size: 0.75em; color: #0A66C2; font-weight: 600;">Connect</div>
                            </div>
                        </a>
                        
                        <!-- CEH Badge Link -->
                        <a href="https://aspen.eccouncil.org/VerifyBadge?type=certification&a=YrfXz1aC5YByCex1I0vv5+waU+OW6jtHoxZIxIbS++4=" target="_blank" style="display: block; text-decoration: none; transition: transform 0.3s ease; border-bottom: none;" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
                            <div class="speaker-badge speaker-badge-ceh">
                                <div style="width: 90px; height: 90px; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 8px; overflow: hidden;">
                                    <img src="./assets/CEH_2E345519D3F7.png" alt="CEH Badge" style="width: 100%; height: 100%; object-fit: contain;">
                                </div>
                                <div style="font-size: 0.75em; color: #ef4444; font-weight: 500;">Certified</div>
                            </div>
                        </a>
                    </div>
                </div>
                
                <!-- Right Column: Qualifications -->
                <div style="display: flex; flex-direction: column; gap: 25px;">
                    <!-- Name would go here if needed -->
                    
                    <!-- Qualifications List -->
                    <div class="prof-background-box hover-lift">
                        <h3 style="margin-top: 0; margin-bottom: 25px; color: var(--card-h-color); font-size: 1.3em; transition: color 0.3s ease;">
                            <span style="margin-right: 10px;">🎓</span>Professional Background
                        </h3>
                        
                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <!-- Qualification 1 -->
                            <div style="display: flex; gap: 15px; align-items: start;">
                                <div style="background: rgba(59, 130, 246, 0.2); padding: 10px; border-radius: 8px; min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border: 1px solid rgba(59, 130, 246, 0.3);">
                                    <span style="font-size: 1.5em;">💼</span>
                                </div>
                                <div style="flex: 1;">
                                    <div class="prof-title">Principal Software Engineer</div>
                                    <div class="prof-subtitle">Bentley Systems, Inc.</div>
                                </div>
                            </div>
                            
                            <!-- Qualification 2 -->
                            <div style="display: flex; gap: 15px; align-items: start;">
                                <div style="background: rgba(139, 92, 246, 0.2); padding: 10px; border-radius: 8px; min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border: 1px solid rgba(139, 92, 246, 0.3);">
                                    <span style="font-size: 1.5em;">🛡️</span>
                                </div>
                                <div style="flex: 1;">
                                    <div class="prof-title">Advanced Security Champion</div>
                                    <div class="prof-subtitle">Application Security Leadership</div>
                                </div>
                            </div>
                            
                            <!-- Qualification 3 -->
                            <div style="display: flex; gap: 15px; align-items: start;">
                                <div style="background: rgba(239, 68, 68, 0.2); padding: 10px; border-radius: 8px; min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border: 1px solid rgba(239, 68, 68, 0.3);">
                                    <span style="font-size: 1.5em;">🔐</span>
                                </div>
                                <div style="flex: 1;">
                                    <div class="prof-title">Certified Ethical Hacker</div>
                                    <div class="prof-subtitle">EC-Council Certified</div>
                                </div>
                            </div>
                            
                            <!-- Qualification 4 -->
                            <div style="display: flex; gap: 15px; align-items: start;">
                                <div style="background: rgba(34, 197, 94, 0.2); padding: 10px; border-radius: 8px; min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border: 1px solid rgba(34, 197, 94, 0.3);">
                                    <span style="font-size: 1.5em;">👨‍🏫</span>
                                </div>
                                <div style="flex: 1;">
                                    <div class="prof-title">Faculty Member</div>
                                    <div class="prof-subtitle">University of San Jose-Recoletos</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quote or Tagline -->
                    <div class="quote-box hover-lift">
                        "You don't add security to your code. You build it secure from the start. Today, you learned how."
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3: Agenda -->
        <div class="slide">
            <h2 style="margin-bottom: 25px;">Workshop Agenda</h2>
            <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 15px;">
                <div class="agenda-item" onclick="jumpToSlide(4)" style="display: flex; align-items: center; gap: 15px; padding: 10px 16px; background: var(--card-bg); border-radius: 10px; border-left: 4px solid #60a5fa;">
                    <div class="agenda-icon" style="width: 40px; height: 40px; background: rgba(59, 130, 246, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; flex-shrink: 0;">📚</div>
                    <div style="flex: 1; font-size: 1.1em; color: var(--card-text);">Introduction to OWASP ASVS v5.0</div>
                </div>
                <div class="agenda-item" onclick="jumpToSlide(6)" style="display: flex; align-items: center; gap: 15px; padding: 10px 16px; background: var(--card-bg); border-radius: 10px; border-left: 4px solid #a78bfa;">
                    <div class="agenda-icon" style="width: 40px; height: 40px; background: rgba(139, 92, 246, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; flex-shrink: 0;">🔐</div>
                    <div style="flex: 1; font-size: 1.1em; color: var(--card-text);"><strong>Scenario 1:</strong> User Authentication & Login</div>
                </div>
                <div class="agenda-item" onclick="jumpToSlide(10)" style="display: flex; align-items: center; gap: 15px; padding: 10px 16px; background: var(--card-bg); border-radius: 10px; border-left: 4px solid #10b981;">
                    <div class="agenda-icon" style="width: 40px; height: 40px; background: rgba(16, 185, 129, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; flex-shrink: 0;">🛡️</div>
                    <div style="flex: 1; font-size: 1.1em; color: var(--card-text);"><strong>Scenario 2:</strong> API Security & Access Control</div>
                </div>
                <div class="agenda-item" onclick="jumpToSlide(14)" style="display: flex; align-items: center; gap: 15px; padding: 10px 16px; background: var(--card-bg); border-radius: 10px; border-left: 4px solid #f59e0b;">
                    <div class="agenda-icon" style="width: 40px; height: 40px; background: rgba(245, 158, 11, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; flex-shrink: 0;">📁</div>
                    <div style="flex: 1; font-size: 1.1em; color: var(--card-text);"><strong>Scenario 3:</strong> File Upload Security</div>
                </div>
                <div class="agenda-item" onclick="jumpToSlide(19)" style="display: flex; align-items: center; gap: 15px; padding: 10px 16px; background: var(--card-bg); border-radius: 10px; border-left: 4px solid #ec4899;">
                    <div class="agenda-icon" style="width: 40px; height: 40px; background: rgba(236, 72, 153, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; flex-shrink: 0;">🔍</div>
                    <div style="flex: 1; font-size: 1.1em; color: var(--card-text);">ASVS Scavenger Hunt</div>
                </div>
                <div class="agenda-item" onclick="jumpToSlide(21)" style="display: flex; align-items: center; gap: 15px; padding: 10px 16px; background: var(--card-bg); border-radius: 10px; border-left: 4px solid #06b6d4;">
                    <div class="agenda-icon" style="width: 40px; height: 40px; background: rgba(6, 182, 212, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; flex-shrink: 0;">📝</div>
                    <div style="flex: 1; font-size: 1.1em; color: var(--card-text);">Take-Home Assignment</div>
                </div>
                <div class="agenda-item" onclick="jumpToSlide(44)" style="display: flex; align-items: center; gap: 15px; padding: 10px 16px; background: var(--card-bg); border-radius: 10px; border-left: 4px solid #8b5cf6;">
                    <div class="agenda-icon" style="width: 40px; height: 40px; background: rgba(139, 92, 246, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.3em; flex-shrink: 0;">💬</div>
                    <div style="flex: 1; font-size: 1.1em; color: var(--card-text);">Questions & Discussion</div>
                </div>
            </div>
            <div class="key-point" style="margin-top: 30px;">
                <span class="emoji">🎯</span>
                Goal: Map security requirements to user stories using ASVS
            </div>
        </div>

        <!-- Slide 4: Acceptable Use & License Notice -->
        <div class="slide">
            <h2>⚖️ Acceptable Use & License Notice</h2>
            
            <div class="card hover-lift" style="margin-top: 30px; padding: 30px;">
                <h3 style="margin-top: 0; color: #60a5fa;">📄 Purpose</h3>
                <p style="font-size: 1.2em; line-height: 1.6;">
                    The provided sample codes are used to demonstrate OWASP Application Security Verification Standards (ASVS) 5.0 concepts. 
                    It includes intentionally <strong style="color: #ef4444;">insecure ("bad")</strong> examples and improved 
                    <strong style="color: #10b981;">secure ("good")</strong> examples for <strong>educational use only</strong>.
                </p>
            </div>

            <div class="grid-2" style="margin-top: 30px;">
                <div class="card hover-lift">
                    <h3 style="margin-top: 0; color: #10b981;">✅ Acceptable Use</h3>
                    <ul style="font-size: 1.1em;">
                        <li>Use, copy, and adapt for learning, training, and demonstrations</li>
                        <li>Reference the learnings here for educational content</li>
                        <li>Study both insecure and secure patterns</li>
                    </ul>
                </div>
                <div class="card hover-lift">
                    <h3 style="margin-top: 0; color: #ef4444;">⛔ Prohibited Use</h3>
                    <ul style="font-size: 1.1em;">
                        <li>Do NOT deploy "bad" examples to production systems</li>
                        <li>Do NOT present "bad" examples as secure implementations</li>
                        <li>Do NOT use derivative insecure code in real applications</li>
                    </ul>
                </div>
            </div>

            <div class="highlight-box hover-lift" style="margin-top: 30px; background: rgba(139, 92, 246, 0.1); border-left: 4px solid #8b5cf6;">
                <p style="font-size: 1.2em; margin: 0;">
                    <strong>📜 License:</strong> MIT License (code) | 
                    <strong>⚠️ Disclaimer:</strong> Provided "as is" without warranties. Security outcomes depend on your implementation and context.
                </p>
            </div>

            <div class="hover-lift" style="margin-top: 30px; padding: 20px; background: rgba(59, 130, 246, 0.05); border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.2);">
                <p style="font-size: 1.1em; margin: 0; text-align: center;">
                    <strong>Copyright © 2025 Ahdzlee Formentera</strong>
                </p>
            </div>
        </div>

        <!-- Slide 5: What is OWASP ASVS? -->
        <div class="slide">
            <h2>What is OWASP ASVS?</h2>
            <p style="font-size: 1.4em; margin-bottom: 30px;">A comprehensive checklist and framework for <strong>defining security requirements</strong> for web applications.</p>
            
            <div class="grid-2" style="margin-top: 40px;">
                <div class="card hover-lift">
                    <h3 style="margin-top: 0;">📋 What it provides</h3>
                    <ul>
                        <li>Security requirements catalog</li>
                        <li>Three verification levels</li>
                        <li>Testable security controls</li>
                        <li>Industry standard framework</li>
                    </ul>
                </div>
                <div class="card hover-lift">
                    <h3 style="margin-top: 0;">✅ Why use it?</h3>
                    <ul>
                        <li>Build security from the start</li>
                        <li>Reduce vulnerabilities</li>
                        <li>Meet compliance requirements</li>
                        <li>Establish security baseline</li>
                    </ul>
                </div>
            </div>

            <div class="highlight-box" style="margin-top: 40px;">
                <strong style="font-size: 1.4em;">Version 5.0 is the latest release with major restructuring and updated requirements for modern applications</strong>
            </div>
        </div>

        <!-- Slide 6: Key ASVS Chapters -->
        <div class="slide">
            <h2>Key ASVS v5.0 Chapters</h2>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                <div class="card chapter-card">
                    <span class="badge">V6</span>
                    <strong class="card-title">Authentication</strong>
                    <p style="font-size: 1em; margin-top: 10px;">Login, passwords, MFA</p>
                </div>
                <div class="card chapter-card">
                    <span class="badge">V7</span>
                    <strong class="card-title">Session Management</strong>
                    <p style="font-size: 1em; margin-top: 10px;">Session tokens, cookies, logout</p>
                </div>
                <div class="card chapter-card">
                    <span class="badge">V8</span>
                    <strong class="card-title">Authorization</strong>
                    <p style="font-size: 1em; margin-top: 10px;">Access control, IDOR prevention</p>
                </div>
                <div class="card chapter-card">
                    <span class="badge">V2</span>
                    <strong class="card-title">Validation & Business Logic</strong>
                    <p style="font-size: 1em; margin-top: 10px;">Input validation, sanitization</p>
                </div>
                <div class="card chapter-card">
                    <span class="badge">V11</span>
                    <strong class="card-title">Cryptography</strong>
                    <p style="font-size: 1em; margin-top: 10px;">Password hashing, encryption</p>
                </div>
                <div class="card chapter-card">
                    <span class="badge">V16</span>
                    <strong class="card-title">Logging & Error Handling</strong>
                    <p style="font-size: 1em; margin-top: 10px;">Secure logging, error messages</p>
                </div>
                <div class="card chapter-card">
                    <span class="badge">V14</span>
                    <strong class="card-title">Data Protection</strong>
                    <p style="font-size: 1em; margin-top: 10px;">Sensitive data handling, PII</p>
                </div>
                <div class="card chapter-card">
                    <span class="badge">V5</span>
                    <strong class="card-title">File Handling</strong>
                    <p style="font-size: 1em; margin-top: 10px;">File uploads, downloads</p>
                </div>
            </div>
        </div>

        <!-- Slide 6: Scenario 1 - User Story -->
        <div class="slide">
            <h2>Scenario 1: User Login Feature</h2>
            <div class="user-story hover-lift">
                "As a user, I want to log into the application using my email and password so that I can access my account."
            </div>
            
            <h3 style="margin-top: 40px;">🤔 Discussion Question:</h3>
            <div class="highlight-box hover-lift">
                <p style="font-size: 1.5em; margin: 0;">What could go wrong with a login feature?<br>What security concerns should we address?</p>
            </div>

            <div style="margin-top: 40px;">
                <h4>Common Concerns:</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px;">
                    <span class="badge badge-danger">Weak Passwords</span>
                    <span class="badge badge-danger">Brute Force Attacks</span>
                    <span class="badge badge-danger">Credential Stuffing</span>
                    <span class="badge badge-danger">Insecure Storage</span>
                    <span class="badge badge-danger">Session Hijacking</span>
                </div>
            </div>
        </div>

        <!-- Slide 6: Scenario 1 - ASVS Mapping -->
        <div class="slide">
            <h2>Scenario 1: ASVS v5.0 Mapping</h2>
            
            <div class="asvs-mapping hover-lift">
                <h4>V6: Authentication</h4>
                <ul>
                    <li><strong>V6.2.1</strong> - Password length (minimum 8, recommend 15+ characters)</li>
                    <li><strong>V6.2.5</strong> - Passwords of any composition can be used (no character restrictions)</li>
                    <li><strong>V6.3.1</strong> - Controls to prevent credential stuffing and brute force attacks</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V11: Cryptography</h4>
                <ul>
                    <li><strong>V11.4.2</strong> - Passwords stored using approved key derivation functions (Argon2id, scrypt, bcrypt, PBKDF2)</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V7: Session Management</h4>
                <ul>
                    <li><strong>V7.2.4</strong> - Generate new session token after authentication</li>
                    <li><strong>V7.3.1</strong> - Inactivity timeout with re-authentication</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V2: Validation</h4>
                <ul>
                    <li><strong>V2.2.1</strong> - Input validation at trusted service layer</li>
                </ul>
            </div>
        </div>

        <!-- Slide 7: Scenario 1 - Bad Code -->
        <div class="slide">
            <h2>❌ Bad Code: Vulnerable Login</h2>
            <div class="code-block"><span class="comment"># Python/Flask Example - INSECURE</span>
<span class="keyword">@app</span>.route(<span class="string">'/login'</span>, methods=[<span class="string">'POST'</span>])
<span class="keyword">def</span> login():
    email = request.form[<span class="string">'email'</span>]
    password = request.form[<span class="string">'password'</span>]
    
    <span class="comment"># VULNERABILITY 1: Using weak hashing (MD5)</span>
    password_hash = hashlib.md5(password.encode()).hexdigest()
    
    <span class="comment"># VULNERABILITY 2: SQL Injection vulnerability</span>
    user = db.query(<span class="string">f"SELECT * FROM users WHERE email='{email}'"</span>)
    
    <span class="keyword">if</span> user:
        <span class="comment"># VULNERABILITY 3: No session regeneration</span>
        session[<span class="string">'user_id'</span>] = user.id
        <span class="keyword">return</span> <span class="string">"Login successful"</span></div>

            <div class="vulnerability-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #c62828;">🚨 Critical Issues:</strong>
                <ul style="margin-top: 15px;">
                    <li>Weak MD5 hashing - easily cracked</li>
                    <li>No rate limiting - brute force vulnerable</li>
                    <li>SQL injection risk</li>
                    <li>Session fixation vulnerability</li>
                </ul>
            </div>
        </div>

        <!-- Slide 8: Scenario 1 - Good Code -->
        <div class="slide">
            <h2>✅ Good Code: Secure Login</h2>
            <div class="code-block" style="max-height: 350px;"><span class="keyword">from</span> flask_limiter <span class="keyword">import</span> Limiter
<span class="keyword">import</span> bcrypt

<span class="comment"># V6.3.1: Rate limiting to prevent brute force</span>
limiter = Limiter(app, default_limits=[<span class="string">"200 per day"</span>])

<span class="keyword">@app</span>.route(<span class="string">'/login'</span>, methods=[<span class="string">'POST'</span>])
<span class="keyword">@limiter</span>.limit(<span class="string">"5 per minute"</span>)
<span class="keyword">def</span> login():
    email = request.form[<span class="string">'email'</span>].strip()
    password = request.form[<span class="string">'password'</span>]
    
    <span class="comment"># V6.2.1: Password length validation</span>
    <span class="keyword">if</span> len(password) < 8 or len(password) > 128:
        <span class="keyword">return</span> {<span class="string">"error"</span>: <span class="string">"Invalid credentials"</span>}, 401
    
    <span class="comment"># V2.2.1: Parameterized queries prevent SQL injection</span>
    query = text(<span class="string">"SELECT * FROM users WHERE email = :email"</span>)
    user = db.execute(query, {<span class="string">"email"</span>: email})
    
    <span class="comment"># V11.4.2: Verify password with bcrypt</span>
    <span class="keyword">if</span> user and bcrypt.checkpw(password.encode(), user.password_hash):
        <span class="comment"># V7.2.4: Regenerate session after authentication</span>
        session.regenerate()
        session[<span class="string">'user_id'</span>] = user.id
        <span class="keyword">return</span> {<span class="string">"success"</span>: True}</div>

            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px;">
                    <li>Bcrypt password hashing (V11.4.2)</li>
                    <li>Rate limiting prevents brute force (V6.3.1)</li>
                    <li>Parameterized queries (V2.2.1)</li>
                    <li>Session regeneration (V7.2.4)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 9: Scenario 2 - User Story -->
        <div class="slide">
            <h2>Scenario 2: User Profile API</h2>
            <div class="user-story hover-lift">
                "As an authenticated user, I want to retrieve my profile information via API so that I can display it in the mobile app."
            </div>
            
            <div class="api-endpoint-box hover-lift">
                <strong class="api-endpoint-label">API Endpoint:</strong> <span class="api-endpoint-text">GET /api/users/{userId}/profile</span>
            </div>

            <h3 style="margin-top: 30px;">🤔 Discussion Question:</h3>
            <div class="highlight-box hover-lift">
                <p style="font-size: 1.5em; margin: 0;">What security risks exist when exposing user data through an API?</p>
            </div>

            <div style="margin-top: 30px;">
                <h4>Common Risks:</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px;">
                    <span class="badge badge-danger">Unauthorized Access</span>
                    <span class="badge badge-danger">IDOR Vulnerabilities</span>
                    <span class="badge badge-danger">Data Over-exposure</span>
                    <span class="badge badge-danger">Missing Authorization</span>
                </div>
            </div>
        </div>

        <!-- Slide 10: Scenario 2 - ASVS Mapping -->
        <div class="slide">
            <h2>Scenario 2: ASVS v5.0 Mapping</h2>
            
            <div class="asvs-mapping hover-lift">
                <h4>V8: Authorization</h4>
                <ul>
                    <li><strong>V8.2.1</strong> - Function-level access restricted to consumers with explicit permissions</li>
                    <li><strong>V8.2.2</strong> - Data-specific access restricted to prevent IDOR and BOLA</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V4: API and Web Service</h4>
                <ul>
                    <li><strong>V4.1.1</strong> - Proper Content-Type headers in HTTP responses</li>
                    <li><strong>V4.1.2</strong> - User-facing endpoints redirect HTTP to HTTPS appropriately</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V14: Data Protection</h4>
                <ul>
                    <li><strong>V14.2.1</strong> - Sensitive data only in HTTP body or headers, not in URL</li>
                    <li><strong>V14.3.2</strong> - Anti-caching headers for sensitive data</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V2: Validation</h4>
                <ul>
                    <li><strong>V2.2.2</strong> - Input validation at trusted service layer</li>
                </ul>
            </div>
        </div>

        <!-- Slide 11: Scenario 2 - Bad Code -->
        <div class="slide">
            <h2>❌ Bad Code: Vulnerable API</h2>
            <div class="code-block"><span class="comment"># Python/Flask API - INSECURE</span>
<span class="keyword">@app</span>.route(<span class="string">'/api/users/&lt;user_id&gt;/profile'</span>)
<span class="keyword">def</span> get_profile(user_id):
    <span class="comment"># VULNERABILITY 1: No authentication check</span>
    <span class="comment"># VULNERABILITY 2: No authorization check (IDOR)</span>
    
    user = db.query(User).filter_by(id=user_id).first()
    
    <span class="keyword">if</span> user:
        <span class="comment"># VULNERABILITY 3: Exposing sensitive data</span>
        <span class="keyword">return</span> jsonify({
            <span class="string">'id'</span>: user.id,
            <span class="string">'email'</span>: user.email,
            <span class="string">'ssn'</span>: user.ssn,  <span class="comment"># Should NEVER be exposed!</span>
            <span class="string">'password_hash'</span>: user.password_hash,  <span class="comment"># Never expose!</span>
            <span class="string">'salary'</span>: user.salary,
            <span class="string">'credit_card'</span>: user.credit_card
        })</div>

            <div class="vulnerability-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #c62828;">🚨 Critical Issues:</strong>
                <ul style="margin-top: 15px;">
                    <li><strong>IDOR (V8.2.2):</strong> Any user can access any profile</li>
                    <li><strong>Data Exposure (V14.2.1):</strong> Sensitive fields exposed</li>
                    <li><strong>No Authentication:</strong> Endpoint accessible without login</li>
                </ul>
            </div>
        </div>

        <!-- Slide 12: Scenario 2 - Good Code -->
        <div class="slide">
            <h2>✅ Good Code: Secure API</h2>
            <div class="code-block" style="max-height: 350px;"><span class="comment"># V6: Authentication middleware</span>
<span class="keyword">def</span> require_auth(f):
    <span class="keyword">def</span> decorated(*args, **kwargs):
        token = request.headers.get(<span class="string">'Authorization'</span>)
        <span class="keyword">if</span> not token:
            <span class="keyword">return</span> jsonify({<span class="string">'error'</span>: <span class="string">'Unauthorized'</span>}), 401
        g.current_user_id = verify_token(token)
        <span class="keyword">return</span> f(*args, **kwargs)
    <span class="keyword">return</span> decorated

<span class="keyword">@app</span>.route(<span class="string">'/api/users/&lt;int:user_id&gt;/profile'</span>)
<span class="keyword">@require_auth</span>
<span class="keyword">def</span> get_profile(user_id):
    <span class="comment"># V8.2.2: Authorization - users can only access their own data</span>
    <span class="keyword">if</span> g.current_user_id != user_id:
        logger.warning(<span class="string">f"IDOR attempt by {g.current_user_id}"</span>)
        <span class="keyword">return</span> jsonify({<span class="string">'error'</span>: <span class="string">'Forbidden'</span>}), 403
    
    user = db.query(User).filter_by(id=user_id).first()
    
    <span class="comment"># V14.2.1: Return only non-sensitive data</span>
    response = jsonify({
        <span class="string">'id'</span>: user.id,
        <span class="string">'email'</span>: user.email,
        <span class="string">'full_name'</span>: user.full_name
        <span class="comment"># No SSN, password_hash, credit_card!</span>
    })
    
    <span class="comment"># V14.3.2: Prevent caching of sensitive data</span>
    response.headers[<span class="string">'Cache-Control'</span>] = <span class="string">'no-store'</span>
    <span class="keyword">return</span> response</div>

            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px; font-size: 1em;">
                    <li>Authentication required</li>
                    <li>Authorization enforced (V8.2.2)</li>
                    <li>Minimal data exposure (V14.2.1)</li>
                    <li>No caching (V14.3.2)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 13: Scenario 3 - User Story -->
        <div class="slide">
            <h2>Scenario 3: File Upload Feature</h2>
            <div class="user-story hover-lift">
                "As a user, I want to upload my profile picture so that other users can see my photo."
            </div>
            
            <div class="api-endpoint-box hover-lift">
                <strong class="api-endpoint-label">API Endpoint:</strong> <span class="api-endpoint-text">POST /api/users/profile-picture</span>
            </div>

            <h3 style="margin-top: 30px;">🤔 Discussion Question:</h3>
            <div class="highlight-box hover-lift">
                <p style="font-size: 1.5em; margin: 0;">What can go wrong when users upload files?</p>
            </div>

            <div style="margin-top: 30px;">
                <h4>Common Risks:</h4>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 20px;">
                    <span class="badge badge-danger">Malicious Files</span>
                    <span class="badge badge-danger">Path Traversal</span>
                    <span class="badge badge-danger">XSS via Files</span>
                    <span class="badge badge-danger">Storage Exhaustion</span>
                    <span class="badge badge-danger">Remote Code Execution</span>
                </div>
            </div>
        </div>

        <!-- Slide 14: Scenario 3 - ASVS Mapping -->
        <div class="slide">
            <h2>Scenario 3: ASVS v5.0 Mapping</h2>
            
            <div class="asvs-mapping hover-lift">
                <h4>V5: File Handling</h4>
                <ul>
                    <li><strong>V5.4.1</strong> - Validate or ignore user-submitted filenames</li>
                    <li><strong>V5.3.2</strong> - Use internally generated filenames to prevent path traversal</li>
                    <li><strong>V5.2.1</strong> - File size limits to prevent DoS</li>
                    <li><strong>V5.4.2</strong> - Filenames encoded/sanitized when serving</li>
                    <li><strong>V5.1.1</strong> - Document permitted file types and maximum sizes</li>
                    <li><strong>V5.3.3</strong> - Server-side processing ignores user-provided paths</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V2: Validation</h4>
                <ul>
                    <li><strong>V2.2.1</strong> - Input validation for file metadata</li>
                </ul>
            </div>
        </div>

        <!-- Slide 15: Scenario 3 - Bad Code -->
        <div class="slide">
            <h2>❌ Bad Code: Vulnerable Upload</h2>
            <div class="code-block"><span class="comment"># Python/Flask - INSECURE</span>
<span class="keyword">@app</span>.route(<span class="string">'/api/users/profile-picture'</span>, methods=[<span class="string">'POST'</span>])
<span class="keyword">def</span> upload_profile_picture():
    file = request.files[<span class="string">'profile_picture'</span>]
    
    <span class="comment"># VULNERABILITY 1: No file validation</span>
    file_content = file.read()
    
    <span class="comment"># VULNERABILITY 2: Using user filename (path traversal!)</span>
    filename = file.filename
    
    <span class="comment"># VULNERABILITY 3: No file size limit</span>
    <span class="comment"># VULNERABILITY 4: Storing in web-accessible directory</span>
    upload_path = os.path.join(<span class="string">'/var/www/html/uploads'</span>, filename)
    file.save(upload_path)
    
    <span class="comment"># VULNERABILITY 5: Returning direct file path</span>
    <span class="keyword">return</span> jsonify({
        <span class="string">'file_url'</span>: <span class="string">f'/uploads/{filename}'</span>
    })</div>

            <div class="vulnerability-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #c62828;">🚨 Critical Issues:</strong>
                <ul style="margin-top: 15px;">
                    <li><strong>Path Traversal (V5.3.2):</strong> Can upload to <code>../../etc/passwd</code></li>
                    <li><strong>No Validation (V5.4.1):</strong> Can upload .php, .exe, malicious files</li>
                    <li><strong>DoS Risk (V5.2.1):</strong> No size limits</li>
                </ul>
            </div>
        </div>

        <!-- Slide 16: Scenario 3 - Good Code Part 1 -->
        <div class="slide">
            <h2>✅ Good Code: Secure Upload (Part 1)</h2>
            <div class="code-block" style="max-height: 650px;"><span class="keyword">import</span> uuid, magic
<span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename

<span class="comment"># V5.2.1: Maximum file size</span>
MAX_FILE_SIZE = 5 * 1024 * 1024

<span class="comment"># V5.4.1: Allowed MIME types</span>
ALLOWED_MIME_TYPES = [<span class="string">'image/jpeg'</span>, <span class="string">'image/png'</span>, <span class="string">'image/gif'</span>]

<span class="keyword">@app</span>.route(<span class="string">'/api/users/profile-picture'</span>, methods=[<span class="string">'POST'</span>])
<span class="keyword">@require_auth</span>
<span class="keyword">def</span> upload_profile_picture():
    file = request.files[<span class="string">'profile_picture'</span>]
    
    <span class="comment"># V5.2.1: Check file size</span>
    file.seek(0, os.SEEK_END)
    file_size = file.tell()
    <span class="keyword">if</span> file_size > MAX_FILE_SIZE:
        <span class="keyword">return</span> jsonify({<span class="string">'error'</span>: <span class="string">'File too large'</span>}), 400
    
    file.seek(0)
    file_content = file.read()
    
    <span class="comment"># V5.4.1: Validate using magic numbers (not extension!)</span>
    mime = magic.Magic(mime=True)
    detected_mime = mime.from_buffer(file_content)
    
    <span class="keyword">if</span> detected_mime not in ALLOWED_MIME_TYPES:
        <span class="keyword">return</span> jsonify({<span class="string">'error'</span>: <span class="string">'Invalid file type'</span>}), 400</div>

            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented (Part 1):</strong>
                <ul style="margin-top: 15px; font-size: 1em;">
                    <li>File size validation - 5MB limit (V5.2.1)</li>
                    <li>Magic number validation using python-magic (V5.4.1)</li>
                    <li>Whitelist allowed MIME types (V5.4.1)</li>
                    <li>Authentication required for upload (@require_auth)</li>
                </ul>
            </div>
            <div class="scroll-indicator">Scroll or see next slide for more →</div>
        </div>

        <!-- Slide 17: Scenario 3 - Good Code Part 2 -->
        <div class="slide">
            <h2>✅ Good Code: Secure Upload (Part 2)</h2>
            <div class="code-block" style="max-height: 650px;">    <span class="comment"># V5.3.2: Generate unique filename (don't use original)</span>
    file_extension = os.path.splitext(secure_filename(file.filename))[1]
    unique_filename = <span class="string">f"{uuid.uuid4()}{file_extension}"</span>
    
    <span class="comment"># V5.3.2: Store outside web root (not web-accessible)</span>
    upload_dir = <span class="string">'/var/app/uploads'</span>  <span class="comment"># Not in /var/www/html!</span>
    file_path = os.path.join(upload_dir, unique_filename)
    
    <span class="comment"># V5.3.2: Prevent path traversal</span>
    <span class="keyword">if</span> not os.path.abspath(file_path).startswith(upload_dir):
        <span class="keyword">return</span> jsonify({<span class="string">'error'</span>: <span class="string">'Invalid path'</span>}), 400
    
    <span class="keyword">with</span> open(file_path, <span class="string">'wb'</span>) <span class="keyword">as</span> f:
        f.write(file_content)
    
    <span class="comment"># V5.4.2: In production, scan for malware</span>
    <span class="comment"># scan_for_malware(file_path)</span>
    
    <span class="comment"># Store reference in database</span>
    db.execute(<span class="string">"UPDATE users SET profile_picture = :file"</span>, 
               {<span class="string">"file"</span>: unique_filename})
    
    <span class="comment"># V5.4.1: Return reference, not direct path</span>
    <span class="keyword">return</span> jsonify({<span class="string">'file_id'</span>: unique_filename})</div>

            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px; font-size: 1em;">
                    <li>Magic number validation (V5.4.1)</li>
                    <li>Size limits (V5.2.1)</li>
                    <li>Unique filenames (V5.3.2)</li>
                    <li>Files stored outside web root</li>
                    <li>Path traversal prevention (V5.3.3)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 18: Interactive Exercise -->
        <div class="slide">
            <h2>🎯 Interactive Exercise</h2>
            <div class="highlight-box" style="margin-top: 30px;">
                <h3 class="highlight-title" style="margin: 0; font-size: 2em;">ASVS Scavenger Hunt</h3>
            </div>

            <div class="scavenger-scenario hover-lift">
                <h4>Scenario:</h4>
                <p style="font-size: 1.3em; margin: 0;">
                    "Your team is building a <strong style="color: var(--link-color);">password reset feature</strong>. Users receive a reset link via email."
                </p>
            </div>

            <div class="scavenger-task hover-lift">
                <h4 style="margin-top: 0; color: var(--badge-warning-color); transition: color 0.3s ease;">🔍 Your Task:</h4>
                <p style="font-size: 1.2em; margin-bottom: 20px;">Navigate the ASVS v5.0 documentation and find relevant security requirements for this feature.</p>
                <p style="font-size: 1.1em; margin: 0;"><strong>Time:</strong> 5 minutes</p>
            </div>
        </div>

        <!-- Slide 19: Exercise Solution -->
        <div class="slide">
            <h2>Exercise Solution</h2>
            <h3 style="color: #4ade80;">Password Reset Requirements</h3>
            
            <div class="asvs-mapping hover-lift">
                <h4>Key ASVS v5.0 Requirements Found:</h4>
                <ul>
                    <li><strong>V6.4.3</strong> - Secure password reset process that doesn't bypass MFA</li>
                    <li><strong>V6.2.3</strong> - Password change requires current password</li>
                    <li><strong>V7.2.4</strong> - Token regeneration after password reset</li>
                    <li><strong>V16.1.1</strong> - Log security-relevant events (password reset requests)</li>
                    <li><strong>V12.2.1</strong> - Use TLS for sensitive operations like password reset</li>
                    <li><strong>V6.4.4</strong> - Evidence of identity proofing when MFA factor is lost</li>
                </ul>
            </div>

            <div class="key-point" style="margin-top: 30px;">
                Real-world Impact: These requirements prevent account takeover attacks!
            </div>
        </div>

        <!-- Slide 20: Take-Home Assignment Intro -->
        <div class="slide">
            <h2 style="margin-bottom: 40px;">🏠 Take-Home Assignment</h2>
            <div style="display: flex; flex-direction: column; justify-content: flex-start; padding-top: 0px;">
                <div class="highlight-box" style="margin-top: 10px;">
                    <h3 class="highlight-title" style="margin: 0; font-size: 2.5em; font-weight: 700;">Phoenix Notes Application</h3>
                    <p class="highlight-title" style="font-size: 1.3em; margin-top: 15px;">A practical exercise to apply ASVS v5.0 to a complete application</p>
                </div>

                <div class="app-overview-box hover-lift" style="margin-top: 25px;">
                    <h3 style="margin-top: 0;">Application Overview</h3>
                    <p style="font-size: 1.2em; line-height: 1.8;">
                        Phoenix Notes is a web application that allows users to register, log in, and manage personal notes with profile pictures.
                    </p>
                </div>

                <div class="grid-2" style="margin-top: 20px;">
                    <div class="card hover-lift">
                        <h4 style="margin-top: 0;">📝 Features</h4>
                        <ul style="font-size: 1em;">
                            <li>User Registration & Login</li>
                            <li>Note Management (CRUD)</li>
                            <li>Profile Picture Upload</li>
                        </ul>
                    </div>
                    <div class="card hover-lift">
                        <h4 style="margin-top: 0;">💻 Technologies</h4>
                        <ul style="font-size: 1em;">
                            <li>TypeScript (Auth)</li>
                            <li>C#.NET (Notes & Upload)</li>
                            <li>RESTful API with JSON</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 21: Feature 1 - User Registration -->
        <div class="slide">
            <h2>Feature 1: User Registration & Login</h2>
            
            <div class="user-story hover-lift">
                <strong>User Stories:</strong><br>
                • As a new user, I want to create an account with my email and password<br>
                • As a registered user, I want to log in with my email and password<br>
                • As a logged-in user, I want to be able to log out
            </div>

            <h3 style="margin-top: 30px;">🎯 Your Task:</h3>
            <div class="hover-lift" style="background: rgba(59, 130, 246, 0.15); padding: 25px; border-radius: 10px; border: 2px solid rgba(59, 130, 246, 0.3); margin-top: 20px;">
                <p style="font-size: 1.2em; margin: 0;">
                    1. Identify security risks in the registration and login process<br>
                    2. Map relevant ASVS v5.0 controls<br>
                    3. Review the code examples and identify vulnerabilities<br>
                    4. Understand the secure implementation
                </p>
            </div>
        </div>

        <!-- Slide 22: Feature 1 - ASVS Mapping -->
        <div class="slide">
            <h2>Feature 1: ASVS v5.0 Mapping</h2>
            
            <div class="asvs-mapping hover-lift">
                <h4>V6: Authentication</h4>
                <ul>
                    <li><strong>V6.2.1</strong> - Password minimum 8 characters (15+ recommended)</li>
                    <li><strong>V6.2.5</strong> - No restrictions on password composition</li>
                    <li><strong>V6.3.1</strong> - Brute force and credential stuffing prevention</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V11: Cryptography</h4>
                <ul>
                    <li><strong>V11.4.2</strong> - Passwords stored with approved KDF (bcrypt, Argon2id, scrypt)</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V7: Session Management</h4>
                <ul>
                    <li><strong>V7.2.4</strong> - Generate new session token on authentication</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V2: Validation and V16: Logging</h4>
                <ul>
                    <li><strong>V2.2.1, V2.2.2</strong> - Input validation at trusted service layer</li>
                    <li><strong>V16.1.1</strong> - Log authentication events</li>
                </ul>
            </div>
        </div>

        <!-- Slide 23: Feature 1 - Bad Code (TypeScript) -->
        <div class="slide">
            <h2>❌ Bad Code: User Registration (TypeScript)</h2>
            <div class="code-block"><span class="comment">// INSECURE - Node.js/Express/TypeScript</span>
<span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">'express'</span>;
<span class="keyword">import</span> crypto <span class="keyword">from</span> <span class="string">'crypto'</span>;

app.post(<span class="string">'/api/register'</span>, <span class="keyword">async</span> (req, res) <span class="keyword">=></span> {
    <span class="keyword">const</span> { email, password } = req.body;
    
    <span class="comment">// VULNERABILITY 1: No password validation</span>
    <span class="comment">// VULNERABILITY 2: Weak hashing (SHA256)</span>
    <span class="keyword">const</span> passwordHash = crypto.createHash(<span class="string">'sha256'</span>)
        .update(password).digest(<span class="string">'hex'</span>);
    
    <span class="comment">// VULNERABILITY 3: SQL Injection</span>
    <span class="keyword">const</span> query = <span class="string">`INSERT INTO users (email, password_hash) 
                   VALUES ('${email}', '${passwordHash}')`</span>;
    <span class="keyword">await</span> db.query(query);
    
    res.json({ <span class="string">success</span>: <span class="keyword">true</span> });
});

app.post(<span class="string">'/api/login'</span>, <span class="keyword">async</span> (req, res) <span class="keyword">=></span> {
    <span class="keyword">const</span> { email, password } = req.body;
    
    <span class="comment">// VULNERABILITY 4: No rate limiting</span>
    <span class="keyword">const</span> hash = crypto.createHash(<span class="string">'sha256'</span>).update(password).digest(<span class="string">'hex'</span>);
    <span class="keyword">const</span> user = <span class="keyword">await</span> db.query(
        <span class="string">`SELECT * FROM users WHERE email='${email}' AND password_hash='${hash}'`</span>
    );
    
    <span class="comment">// VULNERABILITY 5: No session regeneration</span>
    req.session.userId = user.id;
    res.json({ <span class="string">success</span>: <span class="keyword">true</span> });
});</div>
            <div class="vulnerability-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #c62828;">🚨 Issues:</strong>
                <ul style="margin-top: 15px;">
                    <li>Weak hashing</li>
                    <li>SQL injection</li>
                    <li>No rate limiting</li>
                    <li>No validation</li>
                    <li>No session regeneration</li>
                </ul>
            </div>
        </div>

        <!-- Slide 24: Feature 1 - Good Code (TypeScript) -->
        <div class="slide">
            <h2>✅ Good Code: User Registration (TypeScript)</h2>
            <div class="code-block" style="max-height: 650px;"><span class="comment">// SECURE - Node.js/Express/TypeScript</span>
<span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">'express'</span>;
<span class="keyword">import</span> bcrypt <span class="keyword">from</span> <span class="string">'bcrypt'</span>;
<span class="keyword">import</span> rateLimit <span class="keyword">from</span> <span class="string">'express-rate-limit'</span>;
<span class="keyword">import</span> { body, validationResult } <span class="keyword">from</span> <span class="string">'express-validator'</span>;

<span class="comment">// V6.3.1: Rate limiting</span>
<span class="keyword">const</span> authLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, <span class="comment">// 15 minutes</span>
    max: 5
});

<span class="comment">// V2.2.1: Input validation middleware</span>
<span class="keyword">const</span> registerValidation = [
    body(<span class="string">'email'</span>).isEmail().normalizeEmail(),
    body(<span class="string">'password'</span>).isLength({ min: 8, max: 128 })
];

app.post(<span class="string">'/api/register'</span>, registerValidation, <span class="keyword">async</span> (req, res) <span class="keyword">=></span> {
    <span class="comment">// V2.2.2: Check validation results</span>
    <span class="keyword">const</span> errors = validationResult(req);
    <span class="keyword">if</span> (!errors.isEmpty()) {
        <span class="keyword">return</span> res.status(400).json({ errors: errors.array() });
    }
    
    <span class="keyword">const</span> { email, password } = req.body;
    
    <span class="comment">// V11.4.2: Bcrypt with work factor 12</span>
    <span class="keyword">const</span> saltRounds = 12;
    <span class="keyword">const</span> passwordHash = <span class="keyword">await</span> bcrypt.hash(password, saltRounds);
    
    <span class="comment">// V2.2.1: Parameterized query</span>
    <span class="keyword">await</span> db.query(
        <span class="string">'INSERT INTO users (email, password_hash) VALUES ($1, $2)'</span>,
        [email, passwordHash]
    );
    
    <span class="comment">// V16.1.1: Log registration</span>
    logger.info(<span class="string">`New user registered: ${email}`</span>);
    
    res.status(201).json({ <span class="string">success</span>: <span class="keyword">true</span> });
});</div>
            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px;">
                    <li>Bcrypt password hashing with work factor 12 (V11.4.2)</li>
                    <li>Input validation on email and password (V2.2.1, V2.2.2)</li>
                    <li>Parameterized queries prevent SQL injection (V2.2.1)</li>
                    <li>Security event logging for registration (V16.1.1)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 25: Feature 1 - Login Good Code (TypeScript) -->
        <div class="slide">
            <h2>✅ Good Code: User Login (TypeScript)</h2>
            <div class="code-block" style="max-height: 750px;">app.post(<span class="string">'/api/login'</span>, authLimiter, <span class="keyword">async</span> (req, res) <span class="keyword">=></span> {
    <span class="keyword">const</span> { email, password } = req.body;
    
    <span class="comment">// V2.2.1: Validate input</span>
    <span class="keyword">if</span> (!email || !password) {
        <span class="keyword">return</span> res.status(401).json({ error: <span class="string">'Invalid credentials'</span> });
    }
    
    <span class="comment">// V6.2.1: Password length check</span>
    <span class="keyword">if</span> (password.length < 8 || password.length > 128) {
        <span class="keyword">return</span> res.status(401).json({ error: <span class="string">'Invalid credentials'</span> });
    }
    
    <span class="comment">// V2.2.1: Parameterized query</span>
    <span class="keyword">const</span> result = <span class="keyword">await</span> db.query(
        <span class="string">'SELECT id, password_hash FROM users WHERE email = $1'</span>,
        [email]
    );
    
    <span class="keyword">if</span> (result.rows.length === 0) {
        <span class="comment">// V16.1.1: Log failed attempt</span>
        logger.warn(<span class="string">`Failed login attempt for ${email}`</span>);
        <span class="keyword">return</span> res.status(401).json({ error: <span class="string">'Invalid credentials'</span> });
    }
    
    <span class="keyword">const</span> user = result.rows[0];
    
    <span class="comment">// V11.4.2: Verify with bcrypt</span>
    <span class="keyword">const</span> validPassword = <span class="keyword">await</span> bcrypt.compare(password, user.password_hash);
    
    <span class="keyword">if</span> (!validPassword) {
        logger.warn(<span class="string">`Failed login for ${email}`</span>);
        <span class="keyword">return</span> res.status(401).json({ error: <span class="string">'Invalid credentials'</span> });
    }
    
    <span class="comment">// V7.2.4: Regenerate session</span>
    req.session.regenerate((err) <span class="keyword">=></span> {
        <span class="keyword">if</span> (err) <span class="keyword">return</span> res.status(500).json({ error: <span class="string">'Login failed'</span> });
        req.session.userId = user.id;
        logger.info(<span class="string">`Successful login: ${user.id}`</span>);
        res.json({ <span class="string">success</span>: <span class="keyword">true</span> });
    });
});</div>
            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px;">
                    <li>Rate limiting prevents brute force attacks (V6.3.1)</li>
                    <li>Input validation on email and password (V2.2.1, V6.2.1)</li>
                    <li>Parameterized queries prevent SQL injection (V2.2.1)</li>
                    <li>Bcrypt password verification (V11.4.2)</li>
                    <li>Session regeneration after authentication (V7.2.4)</li>
                    <li>Security event logging for login attempts (V16.1.1)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 26: Feature 2 - Note Management -->
        <div class="slide">
            <h2>Feature 2: Note Management</h2>
            
            <div class="user-story hover-lift">
                <strong>User Stories:</strong><br>
                • As a logged-in user, I want to create a new note with title and content<br>
                • As a logged-in user, I want to view a list of all my notes<br>
                • As a logged-in user, I want to view a single note I created<br>
                • As a logged-in user, I want to delete a note I created
            </div>

            <div class="api-endpoint-box hover-lift">
                <strong class="api-endpoint-label">API Endpoints:</strong><br>
                <span class="api-endpoint-text">POST /api/notes - Create note<br>
                GET /api/notes - List all user's notes<br>
                GET /api/notes/{id} - Get single note<br>
                DELETE /api/notes/{id} - Delete note</span>
            </div>

            <h3 style="margin-top: 30px;">🎯 Your Task:</h3>
            <div class="hover-lift" style="background: rgba(59, 130, 246, 0.15); padding: 25px; border-radius: 10px; border: 2px solid rgba(59, 130, 246, 0.3);">
                <p style="font-size: 1.2em; margin: 0;">
                    Focus on: Authorization (IDOR), Input validation, Access control
                </p>
            </div>
        </div>

        <!-- Slide 27: Feature 2 - ASVS Mapping -->
        <div class="slide">
            <h2>Feature 2: ASVS v5.0 Mapping</h2>
            
            <div class="asvs-mapping hover-lift">
                <h4>V8: Authorization (Critical!)</h4>
                <ul>
                    <li><strong>V8.2.1</strong> - Function-level access control (must be authenticated)</li>
                    <li><strong>V8.2.2</strong> - Data-specific access control - users can only access their own notes (IDOR prevention)</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V2: Validation and Business Logic</h4>
                <ul>
                    <li><strong>V2.2.1</strong> - Validate note title and content input</li>
                    <li><strong>V2.2.2</strong> - Server-side input validation</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V14: Data Protection</h4>
                <ul>
                    <li><strong>V14.2.1</strong> - Don't expose sensitive data in URLs</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V16: Logging</h4>
                <ul>
                    <li><strong>V16.1.1</strong> - Log security events (failed access attempts)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 28: Feature 2 - Bad Code (C#) -->
        <div class="slide">
            <h2>❌ Bad Code: Note Management (C#.NET)</h2>
            <div class="code-block" style="max-height: 700px;"><span class="comment">// INSECURE - ASP.NET Core C#</span>
[ApiController]
[Route(<span class="string">"api/[controller]"</span>)]
<span class="keyword">public class</span> NotesController : ControllerBase
{
    <span class="comment">// VULNERABILITY 1: No authentication required</span>
    [HttpGet(<span class="string">"{id}"</span>)]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; GetNote(<span class="keyword">int</span> id)
    {
        <span class="comment">// VULNERABILITY 2: No authorization check (IDOR)</span>
        <span class="comment">// Any user can view any note by changing the ID</span>
        <span class="keyword">var</span> note = <span class="keyword">await</span> _context.Notes.FindAsync(id);
        
        <span class="keyword">if</span> (note == <span class="keyword">null</span>)
            <span class="keyword">return</span> NotFound();
        
        <span class="keyword">return</span> Ok(note);
    }
    
    [HttpPost]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; CreateNote([FromBody] Note note)
    {
        <span class="comment">// VULNERABILITY 3: No input validation</span>
        <span class="comment">// VULNERABILITY 4: No authentication check</span>
        
        _context.Notes.Add(note);
        <span class="keyword">await</span> _context.SaveChangesAsync();
        
        <span class="keyword">return</span> CreatedAtAction(<span class="keyword">nameof</span>(GetNote), 
            <span class="keyword">new</span> { id = note.Id }, note);
    }
    
    [HttpDelete(<span class="string">"{id}"</span>)]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; DeleteNote(<span class="keyword">int</span> id)
    {
        <span class="comment">// VULNERABILITY 5: Users can delete anyone's notes</span>
        <span class="keyword">var</span> note = <span class="keyword">await</span> _context.Notes.FindAsync(id);
        
        _context.Notes.Remove(note);
        <span class="keyword">await</span> _context.SaveChangesAsync();
        
        <span class="keyword">return</span> NoContent();
    }
}</div>
            <div class="vulnerability-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #c62828;">🚨 Critical Issues:</strong>
                <ul style="margin-top: 15px;">
                    <li><strong>IDOR (V8.2.2):</strong> Any user can access any note</li>
                    <li><strong>No Authorization (V8.2.1):</strong> Any user can delete any note</li>
                    <li><strong>No Input Validation (V2.2.1):</strong> Malicious input accepted</li>
                    <li><strong>No Authentication (V6.2.1):</strong> No login required</li>
                </ul>
            </div>
        </div>

        <!-- Slide 29: Feature 2 - Good Code Part 1 (C#) -->
        <div class="slide">
            <h2>✅ Good Code: Note Management (C#.NET) - Part 1</h2>
            <div class="code-block" style="max-height: 700px;"><span class="comment">// SECURE - ASP.NET Core C#</span>
<span class="keyword">using</span> Microsoft.AspNetCore.Authorization;
<span class="keyword">using</span> System.Security.Claims;

[ApiController]
[Route(<span class="string">"api/[controller]"</span>)]
[Authorize] <span class="comment">// V8.2.1: Require authentication</span>
<span class="keyword">public class</span> NotesController : ControllerBase
{
    <span class="keyword">private readonly</span> ApplicationDbContext _context;
    <span class="keyword">private readonly</span> ILogger&lt;NotesController&gt; _logger;
    
    <span class="keyword">private int</span> GetCurrentUserId()
    {
        <span class="keyword">var</span> userIdClaim = User.FindFirst(ClaimTypes.NameIdentifier);
        <span class="keyword">return int</span>.Parse(userIdClaim.Value);
    }
    
    <span class="comment">// V8.2.2: Get only current user's notes</span>
    [HttpGet]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; GetNotes()
    {
        <span class="keyword">var</span> userId = GetCurrentUserId();
        
        <span class="keyword">var</span> notes = <span class="keyword">await</span> _context.Notes
            .Where(n => n.UserId == userId)
            .Select(n => <span class="keyword">new</span> NoteDto 
            { 
                Id = n.Id, 
                Title = n.Title, 
                CreatedAt = n.CreatedAt 
            })
            .ToListAsync();
        
        <span class="keyword">return</span> Ok(notes);
    }
    
    [HttpGet(<span class="string">"{id}"</span>)]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; GetNote(<span class="keyword">int</span> id)
    {
        <span class="keyword">var</span> userId = GetCurrentUserId();
        
        <span class="comment">// V8.2.2: Ensure user can only access their own notes</span>
        <span class="keyword">var</span> note = <span class="keyword">await</span> _context.Notes
            .FirstOrDefaultAsync(n => n.Id == id && n.UserId == userId);
        
        <span class="keyword">if</span> (note == <span class="keyword">null</span>)
        {
            <span class="comment">// V16.1.1: Log unauthorized access attempt</span>
            _logger.LogWarning(<span class="string">$"User {userId} attempted to access note {id}"</span>);
            <span class="keyword">return</span> NotFound();
        }
        
        <span class="keyword">return</span> Ok(note);
    }</div>
            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px;">
                    <li>Authentication required with [Authorize] attribute (V8.2.1)</li>
                    <li>IDOR prevention - users can only access their own notes (V8.2.2)</li>
                    <li>Authorization checks using UserId filter (V8.2.2)</li>
                    <li>Security event logging for unauthorized access attempts (V16.1.1)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 30: Feature 2 - Good Code Part 2 (C#) -->
        <div class="slide">
            <h2>✅ Good Code: Note Management (C#.NET) - Part 2</h2>
            <div class="code-block" style="max-height: 750px;">    [HttpPost]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; CreateNote([FromBody] CreateNoteRequest request)
    {
        <span class="comment">// V2.2.1: Validate input</span>
        <span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrWhiteSpace(request.Title) || 
            request.Title.Length > 200)
        {
            <span class="keyword">return</span> BadRequest(<span class="string">"Invalid title"</span>);
        }
        
        <span class="keyword">if</span> (<span class="keyword">string</span>.IsNullOrWhiteSpace(request.Content) || 
            request.Content.Length > 10000)
        {
            <span class="keyword">return</span> BadRequest(<span class="string">"Invalid content"</span>);
        }
        
        <span class="keyword">var</span> userId = GetCurrentUserId();
        
        <span class="keyword">var</span> note = <span class="keyword">new</span> Note
        {
            Title = request.Title,
            Content = request.Content,
            UserId = userId,
            CreatedAt = DateTime.UtcNow
        };
        
        _context.Notes.Add(note);
        <span class="keyword">await</span> _context.SaveChangesAsync();
        
        <span class="comment">// V16.1.1: Log creation</span>
        _logger.LogInformation(<span class="string">$"User {userId} created note {note.Id}"</span>);
        
        <span class="keyword">return</span> CreatedAtAction(<span class="keyword">nameof</span>(GetNote), 
            <span class="keyword">new</span> { id = note.Id }, note);
    }
    
    [HttpDelete(<span class="string">"{id}"</span>)]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; DeleteNote(<span class="keyword">int</span> id)
    {
        <span class="keyword">var</span> userId = GetCurrentUserId();
        
        <span class="comment">// V8.2.2: Ensure user can only delete their own notes</span>
        <span class="keyword">var</span> note = <span class="keyword">await</span> _context.Notes
            .FirstOrDefaultAsync(n => n.Id == id && n.UserId == userId);
        
        <span class="keyword">if</span> (note == <span class="keyword">null</span>)
        {
            _logger.LogWarning(<span class="string">$"User {userId} attempted to delete note {id}"</span>);
            <span class="keyword">return</span> NotFound();
        }
        
        _context.Notes.Remove(note);
        <span class="keyword">await</span> _context.SaveChangesAsync();
        
        _logger.LogInformation(<span class="string">$"User {userId} deleted note {id}"</span>);
        
        <span class="keyword">return</span> NoContent();
    }
}</div>
            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px;">
                    <li>Input validation for title and content (V2.2.1, V2.2.2)</li>
                    <li>Authorization checks - users can only modify their own notes (V8.2.2)</li>
                    <li>Security event logging for create and delete operations (V16.1.1)</li>
                    <li>Failed authorization attempts are logged (V16.1.1)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 31: Feature 3 - Profile Picture Upload -->
        <div class="slide">
            <h2>Feature 3: Profile Picture Upload</h2>
            
            <div class="user-story hover-lift">
                <strong>User Story:</strong><br>
                As a logged-in user, I want to upload a profile picture (JPEG or PNG) so I can personalize my account. The application should store the uploaded picture and display it in my profile area.
            </div>

            <div class="api-endpoint-box hover-lift">
                <strong class="api-endpoint-label">API Endpoint:</strong><br>
                <span class="api-endpoint-text">POST /api/users/profile-picture</span>
            </div>

            <h3 style="margin-top: 30px;">🎯 Your Task:</h3>
            <div class="hover-lift" style="background: rgba(59, 130, 246, 0.15); padding: 25px; border-radius: 10px; border: 2px solid rgba(59, 130, 246, 0.3);">
                <p style="font-size: 1.2em; margin: 0;">
                    Focus on: File type validation, Size limits, Path traversal, Storage location
                </p>
            </div>
        </div>

        <!-- Slide 32: Feature 3 - ASVS Mapping -->
        <div class="slide">
            <h2>Feature 3: ASVS v5.0 Mapping</h2>
            
            <div class="asvs-mapping hover-lift">
                <h4>V5: File Handling</h4>
                <ul>
                    <li><strong>V5.1.1</strong> - Document permitted file types and maximum size</li>
                    <li><strong>V5.2.1</strong> - Enforce file size limits to prevent DoS</li>
                    <li><strong>V5.3.2</strong> - Use internally generated filenames to prevent path traversal</li>
                    <li><strong>V5.4.1</strong> - Validate user-submitted filenames</li>
                    <li><strong>V5.4.2</strong> - Scan files for malware (production requirement)</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V2: Validation</h4>
                <ul>
                    <li><strong>V2.2.1</strong> - Validate file metadata and type</li>
                </ul>
            </div>

            <div class="asvs-mapping hover-lift">
                <h4>V8: Authorization</h4>
                <ul>
                    <li><strong>V8.2.1</strong> - Require authentication for file upload</li>
                </ul>
            </div>
        </div>

        <!-- Slide 33: Feature 3 - Bad Code (C#) -->
        <div class="slide">
            <h2>❌ Bad Code: Profile Picture Upload (C#.NET)</h2>
            <div class="code-block"><span class="comment">// INSECURE - ASP.NET Core C#</span>
[ApiController]
[Route(<span class="string">"api/users"</span>)]
<span class="keyword">public class</span> UsersController : ControllerBase
{
    [HttpPost(<span class="string">"profile-picture"</span>)]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; UploadProfilePicture(IFormFile file)
    {
        <span class="comment">// VULNERABILITY 1: No authentication check</span>
        <span class="comment">// VULNERABILITY 2: No file validation</span>
        <span class="comment">// VULNERABILITY 3: No size limit check</span>
        
        <span class="keyword">if</span> (file == <span class="keyword">null</span>)
            <span class="keyword">return</span> BadRequest(<span class="string">"No file uploaded"</span>);
        
        <span class="comment">// VULNERABILITY 4: Using user-provided filename (path traversal!)</span>
        <span class="keyword">var</span> fileName = file.FileName;
        
        <span class="comment">// VULNERABILITY 5: Storing in web-accessible directory</span>
        <span class="keyword">var</span> filePath = Path.Combine(<span class="string">"wwwroot/uploads"</span>, fileName);
        
        <span class="comment">// VULNERABILITY 6: No path validation</span>
        <span class="keyword">using</span> (<span class="keyword">var</span> stream = <span class="keyword">new</span> FileStream(filePath, FileMode.Create))
        {
            <span class="keyword">await</span> file.CopyToAsync(stream);
        }
        
        <span class="comment">// VULNERABILITY 7: Returning direct file path</span>
        <span class="keyword">return</span> Ok(<span class="keyword">new</span> { fileUrl = <span class="string">f"/uploads/{fileName}"</span> });
    }
}</div>
            <div class="vulnerability-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #c62828;">🚨 Critical Issues:</strong>
                <ul style="margin-top: 15px;">
                    <li>Path traversal</li>
                    <li>No validation</li>
                    <li>Web-accessible storage</li>
                    <li>No authentication</li>
                    <li>No size limits</li>
                </ul>
            </div>
        </div>

        <!-- Slide 34: Feature 3 - Good Code Part 1 (C#) -->
        <div class="slide">
            <h2>✅ Good Code: Profile Picture Upload (C#.NET) - Part 1</h2>
            <div class="code-block" style="max-height: 700px;"><span class="comment">// SECURE - ASP.NET Core C#</span>
<span class="keyword">using</span> SixLabors.ImageSharp;
<span class="keyword">using</span> SixLabors.ImageSharp.Processing;

[ApiController]
[Route(<span class="string">"api/users"</span>)]
[Authorize] <span class="comment">// V8.2.1: Require authentication</span>
<span class="keyword">public class</span> UsersController : ControllerBase
{
    <span class="keyword">private readonly</span> ApplicationDbContext _context;
    <span class="keyword">private readonly</span> ILogger&lt;UsersController&gt; _logger;
    <span class="keyword">private readonly string</span> _uploadPath;
    
    <span class="comment">// V5.1.1: Configuration</span>
    <span class="keyword">private const long</span> MaxFileSize = 5 * 1024 * 1024; <span class="comment">// 5MB</span>
    <span class="keyword">private readonly string</span>[] AllowedExtensions = { <span class="string">".jpg"</span>, <span class="string">".jpeg"</span>, <span class="string">".png"</span> };
    <span class="keyword">private readonly string</span>[] AllowedMimeTypes = 
        { <span class="string">"image/jpeg"</span>, <span class="string">"image/png"</span> };
    
    <span class="keyword">public</span> UsersController(
        ApplicationDbContext context, 
        IConfiguration config,
        ILogger&lt;UsersController&gt; logger)
    {
        _context = context;
        _logger = logger;
        <span class="comment">// V5.3.2: Store outside web root</span>
        _uploadPath = config[<span class="string">"FileUpload:ProfilePicturePath"</span>] 
            ?? Path.Combine(Directory.GetCurrentDirectory(), <span class="string">"uploads"</span>);
        
        Directory.CreateDirectory(_uploadPath);
    }
    
    <span class="keyword">private int</span> GetCurrentUserId()
    {
        <span class="keyword">var</span> userIdClaim = User.FindFirst(ClaimTypes.NameIdentifier);
        <span class="keyword">return int</span>.Parse(userIdClaim.Value);
    }</div>
            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px;">
                    <li>Authentication required with [Authorize] attribute (V8.2.1)</li>
                    <li>File size limits configured (5MB max) (V5.1.1, V5.2.1)</li>
                    <li>Allowed file extensions whitelisted (V5.4.1)</li>
                    <li>Allowed MIME types whitelisted (V2.2.1)</li>
                    <li>Files stored outside web root for security (V5.3.2)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 35: Feature 3 - Good Code Part 2 (C#) -->
        <div class="slide">
            <h2>✅ Good Code: Profile Picture Upload (C#.NET) - Part 2</h2>
            <div class="code-block" style="max-height: 750px;">    [HttpPost(<span class="string">"profile-picture"</span>)]
    <span class="keyword">public async</span> Task&lt;IActionResult&gt; UploadProfilePicture(IFormFile file)
    {
        <span class="keyword">if</span> (file == <span class="keyword">null</span> || file.Length == 0)
            <span class="keyword">return</span> BadRequest(<span class="string">"No file uploaded"</span>);
        
        <span class="comment">// V5.2.1: Check file size</span>
        <span class="keyword">if</span> (file.Length > MaxFileSize)
        {
            _logger.LogWarning(<span class="string">"File size exceeds limit"</span>);
            <span class="keyword">return</span> BadRequest(<span class="string">"File size exceeds 5MB limit"</span>);
        }
        
        <span class="comment">// V5.4.1: Validate file extension</span>
        <span class="keyword">var</span> extension = Path.GetExtension(file.FileName).ToLowerInvariant();
        <span class="keyword">if</span> (!AllowedExtensions.Contains(extension))
        {
            _logger.LogWarning(<span class="string">$"Invalid file extension: {extension}"</span>);
            <span class="keyword">return</span> BadRequest(<span class="string">"Only JPEG and PNG files are allowed"</span>);
        }
        
        <span class="comment">// V2.2.1: Validate MIME type</span>
        <span class="keyword">if</span> (!AllowedMimeTypes.Contains(file.ContentType.ToLowerInvariant()))
        {
            _logger.LogWarning(<span class="string">$"Invalid MIME type: {file.ContentType}"</span>);
            <span class="keyword">return</span> BadRequest(<span class="string">"Invalid file type"</span>);
        }
        
        <span class="keyword">var</span> userId = GetCurrentUserId();
        
        <span class="comment">// V5.3.2: Generate unique filename (don't use user input)</span>
        <span class="keyword">var</span> uniqueFileName = <span class="string">$"{userId}_{Guid.NewGuid()}{extension}"</span>;
        <span class="keyword">var</span> filePath = Path.Combine(_uploadPath, uniqueFileName);
        
        <span class="comment">// V5.3.2: Prevent path traversal</span>
        <span class="keyword">var</span> fullPath = Path.GetFullPath(filePath);
        <span class="keyword">if</span> (!fullPath.StartsWith(Path.GetFullPath(_uploadPath)))
        {
            _logger.LogWarning(<span class="string">$"Path traversal attempt by user {userId}"</span>);
            <span class="keyword">return</span> BadRequest(<span class="string">"Invalid file path"</span>);
        }</div>
            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px;">
                    <li>File size validation enforced (V5.2.1)</li>
                    <li>File extension validation against whitelist (V5.4.1)</li>
                    <li>MIME type validation to prevent spoofing (V2.2.1)</li>
                    <li>Unique filename generation prevents conflicts (V5.3.2)</li>
                    <li>Path traversal attack prevention (V5.3.2)</li>
                    <li>Security event logging for validation failures (V16.1.1)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 36: Feature 3 - Good Code Part 3 (C#) -->
        <div class="slide">
            <h2>✅ Good Code: Profile Picture Upload (C#.NET) - Part 3</h2>
            <div class="code-block" style="max-height: 750px;">        <span class="keyword">try</span>
        {
            <span class="comment">// V5.4.1: Verify it's actually an image by loading it</span>
            <span class="keyword">using</span> (<span class="keyword">var</span> image = <span class="keyword">await</span> Image.LoadAsync(file.OpenReadStream()))
            {
                <span class="comment">// Optional: Resize if too large</span>
                <span class="keyword">if</span> (image.Width > 1000 || image.Height > 1000)
                {
                    image.Mutate(x => x.Resize(<span class="keyword">new</span> ResizeOptions
                    {
                        Size = <span class="keyword">new</span> Size(1000, 1000),
                        Mode = ResizeMode.Max
                    }));
                }
                
                <span class="comment">// Save the validated image</span>
                <span class="keyword">await</span> image.SaveAsync(filePath);
            }
            
            <span class="comment">// V5.4.2: In production, scan for malware here</span>
            <span class="comment">// await _malwareScanner.ScanFileAsync(filePath);</span>
            
            <span class="comment">// Update user's profile picture reference</span>
            <span class="keyword">var</span> user = <span class="keyword">await</span> _context.Users.FindAsync(userId);
            <span class="keyword">if</span> (user != <span class="keyword">null</span>)
            {
                <span class="comment">// Delete old profile picture if exists</span>
                <span class="keyword">if</span> (!<span class="keyword">string</span>.IsNullOrEmpty(user.ProfilePicture))
                {
                    <span class="keyword">var</span> oldPath = Path.Combine(_uploadPath, user.ProfilePicture);
                    <span class="keyword">if</span> (System.IO.File.Exists(oldPath))
                        System.IO.File.Delete(oldPath);
                }
                
                user.ProfilePicture = uniqueFileName;
                <span class="keyword">await</span> _context.SaveChangesAsync();
            }
            
            _logger.LogInformation(<span class="string">$"User {userId} uploaded profile picture"</span>);
            
            <span class="comment">// V5.4.1: Return file ID, not direct path</span>
            <span class="keyword">return</span> Ok(<span class="keyword">new</span> { fileId = uniqueFileName, success = <span class="keyword">true</span> });
        }
        <span class="keyword">catch</span> (Exception ex)
        {
            _logger.LogError(ex, <span class="string">"Error uploading profile picture"</span>);
            <span class="keyword">return</span> StatusCode(500, <span class="string">"Error uploading file"</span>);
        }
    }
}</div>
            <div class="secure-box hover-lift" style="margin-top: 20px;">
                <strong style="color: #2e7d32;">✓ Security Controls Implemented:</strong>
                <ul style="margin-top: 15px;">
                    <li>Image content verification by loading file (V5.4.1)</li>
                    <li>Image resizing to prevent resource exhaustion</li>
                    <li>Malware scanning placeholder for production (V5.4.2)</li>
                    <li>Clean up old files to prevent storage bloat</li>
                    <li>Return file ID instead of direct path (V5.4.1, V14.2.1)</li>
                    <li>Security event logging for uploads (V16.1.1)</li>
                    <li>Error handling with generic messages (V16.2.1)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 37: Assignment Summary -->
        <div class="slide">
            <h2>📝 Assignment Summary</h2>
            
            <div class="card hover-lift" style="margin: 30px 0; padding: 30px;">
                <h3 style="margin-top: 0; color: #667eea;">What You've Learned</h3>
                <div class="grid-2" style="margin-top: 25px;">
                    <div>
                        <h4>Feature 1: Authentication</h4>
                        <ul style="font-size: 0.95em;">
                            <li>Password hashing with bcrypt</li>
                            <li>Rate limiting</li>
                            <li>Session regeneration</li>
                            <li>Input validation</li>
                        </ul>
                    </div>
                    <div>
                        <h4>Feature 2: Note Management</h4>
                        <ul style="font-size: 0.95em;">
                            <li>IDOR prevention</li>
                            <li>Authorization checks</li>
                            <li>Data access control</li>
                            <li>Security logging</li>
                        </ul>
                    </div>
                </div>
                <div style="margin-top: 20px;">
                    <h4>Feature 3: File Upload</h4>
                    <ul style="font-size: 0.95em;">
                        <li>File type validation</li>
                        <li>Path traversal prevention</li>
                        <li>Size limits and storage security</li>
                    </ul>
                </div>
            </div>

            <div class="key-point" style="margin-top: 30px; padding: 18px;">
                <span class="emoji">💡</span>
                Practice by implementing these features in your own projects!
            </div>
        </div>

        <!-- Slide 38: Next Steps -->
        <div class="slide">
            <h2>🚀 Next Steps for Phoenix Notes</h2>
            
            <div class="contact-box hover-lift">
                <h3>Contact & Follow-Up</h3>
                <p style="font-size: 1.2em; line-height: 1.8;">
                    If you have questions about implementing these security controls or want to discuss your solutions, feel free to reach out!
                </p>
            </div>

            <div class="card hover-lift" style="padding: 30px; margin-top: 30px;">
                <h4 style="margin-top: 0;">Additional Practice Ideas:</h4>
                <ul style="font-size: 1.1em; line-height: 2;">
                    <li>Add multi-factor authentication (V6.3.3)</li>
                    <li>Implement note sharing between users (V8 controls)</li>
                    <li>Add password reset functionality (V6.4.3)</li>
                    <li>Implement audit logging (V16 controls)</li>
                    <li>Add API rate limiting per user (V6.3.1)</li>
                    <li>Implement note encryption at rest (V11 controls)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 39: Key Takeaways -->
        <div class="slide">
            <h2>🎓 Key Takeaways</h2>
            
            <div class="card hover-lift" style="margin: 30px 0; padding: 30px;">
                <h3 style="margin-top: 0; color: #667eea;">Security Requirements Process</h3>
                <ol style="font-size: 1.2em; line-height: 2.5; margin-left: 25px;">
                    <li style="margin-bottom: 15px;"><strong>Start with User Stories</strong> - Understand the feature</li>
                    <li style="margin-bottom: 15px;"><strong>Identify Threats</strong> - What can go wrong?</li>
                    <li style="margin-bottom: 15px;"><strong>Map to ASVS v5.0</strong> - Find relevant requirements</li>
                    <li style="margin-bottom: 15px;"><strong>Implement Controls</strong> - Write secure code</li>
                    <li style="margin-bottom: 15px;"><strong>Test & Verify</strong> - Ensure controls work</li>
                </ol>
            </div>

            <div class="comparison" style="margin-top: 30px;">
                <div class="comparison-bad hover-lift">
                    <h4 style="color: #c62828;">❌ Without ASVS</h4>
                    <ul style="font-size: 1em;">
                        <li>Ad-hoc security decisions</li>
                        <li>Inconsistent controls</li>
                        <li>Missing requirements</li>
                        <li>Reactive security</li>
                    </ul>
                </div>
                <div class="comparison-good hover-lift">
                    <h4 style="color: #2e7d32;">✅ With ASVS</h4>
                    <ul style="font-size: 1em;">
                        <li>Systematic approach</li>
                        <li>Comprehensive coverage</li>
                        <li>Industry standards</li>
                        <li>Proactive security</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 40: Security Checklist -->
        <div class="slide">
            <h2>📋 Security Checklist for New Features</h2>
            
            <div class="checklist-box hover-lift">
                <ul class="checklist" style="font-size: 1.05em; line-height: 1.6;">
                    <li>Is authentication required? → Check <strong>V6</strong></li>
                    <li>Can users access others' data? → Check <strong>V8.2.2</strong> (IDOR)</li>
                    <li>Does it accept user input? → Check <strong>V2</strong> (validation)</li>
                    <li>Does it store passwords? → Check <strong>V11.4.2</strong> (bcrypt/Argon2id)</li>
                    <li>Does it handle files? → Check <strong>V5</strong> (validation, storage)</li>
                    <li>Is it an API endpoint? → Check <strong>V4</strong> and <strong>V8</strong></li>
                    <li>Could it fail? → Check <strong>V16</strong> (logging, errors)</li>
                    <li>Does it expose data? → Check <strong>V14</strong> (minimize exposure)</li>
                </ul>
            </div>

            <div class="key-point" style="margin-top: 40px;">
                <span class="emoji">💡</span>
                Make this checklist part of your Definition of Done!
            </div>
        </div>

        <!-- Slide 41: Common Vulnerabilities Mapped -->
        <div class="slide">
            <h2>OWASP Top 10 ↔️ ASVS v5.0</h2>
            
            <div style="display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 30px;">
                <div class="card hover-lift">
                    <strong style="color: #e53935;">A01: Broken Access Control</strong>
                    <p style="margin: 10px 0 0 0; font-size: 1em;">→ ASVS V8 (Authorization)</p>
                </div>
                <div class="card hover-lift">
                    <strong style="color: #e53935;">A02: Cryptographic Failures</strong>
                    <p style="margin: 10px 0 0 0; font-size: 1em;">→ ASVS V11 (Cryptography), V14 (Data Protection)</p>
                </div>
                <div class="card hover-lift">
                    <strong style="color: #e53935;">A03: Injection</strong>
                    <p style="margin: 10px 0 0 0; font-size: 1em;">→ ASVS V2 (Validation), V1 (Encoding & Sanitization)</p>
                </div>
                <div class="card hover-lift">
                    <strong style="color: #e53935;">A05: Security Misconfiguration</strong>
                    <p style="margin: 10px 0 0 0; font-size: 1em;">→ ASVS V16 (Logging), V13 (Configuration)</p>
                </div>
                <div class="card hover-lift">
                    <strong style="color: #e53935;">A07: Authentication Failures</strong>
                    <p style="margin: 10px 0 0 0; font-size: 1em;">→ ASVS V6 (Authentication), V7 (Session Management)</p>
                </div>
                <div class="card hover-lift">
                    <strong style="color: #e53935;">A08: Software & Data Integrity</strong>
                    <p style="margin: 10px 0 0 0; font-size: 1em;">→ ASVS V5 (File Handling), V15 (Secure Coding)</p>
                </div>
            </div>
        </div>

        <!-- Slide 42: Resources -->
        <div class="slide">
            <h2>📚 Resources & Next Steps</h2>
            
            <div style="margin: 20px 0 30px 0;">
                <h3 style="font-size: 1.5em; margin-bottom: 20px; color: var(--h2-color);">✨ Essential Resources</h3>
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <a href="https://owasp.org/www-project-application-security-verification-standard" target="_blank" class="resource-link-item hover-lift" style="text-decoration: none;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div class="resource-icon-small">📘</div>
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 5px 0; font-size: 1.2em; color: var(--card-h-color);">OWASP ASVS v5.0</h4>
                                <div class="resource-url">https://owasp.org/www-project-application-security-verification-standard</div>
                            </div>
                            <div class="resource-arrow-small">→</div>
                        </div>
                    </a>
                    
                    <a href="https://cheatsheetseries.owasp.org/" target="_blank" class="resource-link-item hover-lift" style="text-decoration: none;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div class="resource-icon-small">📝</div>
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 5px 0; font-size: 1.2em; color: var(--card-h-color);">OWASP Cheat Sheet Series</h4>
                                <div class="resource-url">https://cheatsheetseries.owasp.org</div>
                            </div>
                            <div class="resource-arrow-small">→</div>
                        </div>
                    </a>
                    
                    <a href="https://owasp.org/www-project-top-ten" target="_blank" class="resource-link-item hover-lift" style="text-decoration: none;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div class="resource-icon-small">🔟</div>
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 5px 0; font-size: 1.2em; color: var(--card-h-color);">OWASP Top 10</h4>
                                <div class="resource-url">https://owasp.org/www-project-top-ten</div>
                            </div>
                            <div class="resource-arrow-small">→</div>
                        </div>
                    </a>
                </div>
            </div>

            <div class="grid-2" style="margin-top: 30px;">
                <div class="card hover-lift">
                    <h4 style="margin-top: 0;">🛠️ Tools</h4>
                    <ul style="font-size: 1em;">
                        <li>SAST/DAST scanners</li>
                        <li>Dependency checkers</li>
                        <li>Security linters</li>
                    </ul>
                </div>
                <div class="card hover-lift">
                    <h4 style="margin-top: 0;">📖 Learning</h4>
                    <ul style="font-size: 1em;">
                        <li>OWASP WebGoat</li>
                        <li>Security training</li>
                        <li>Code review practices</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 43: Thank You -->
        <div class="slide">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 60px; align-items: center; height: 100%; padding: 0 60px;">
                <!-- Left side: Message -->
                <div style="text-align: left;">
                    <h1 style="font-size: 3.5em; margin-bottom: 30px; background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        Build Security<br>From Day One
                    </h1>
                    
                    <div class="remember-section hover-lift" style="margin: 40px 0;">
                        <h3 style="font-size: 1.5em;">Remember:</h3>
                        <p style="font-size: 1.3em; line-height: 1.8;">
                            Security is not a feature you add at the end. It's a requirement you build from the start.
                        </p>
                    </div>

                    <div class="hover-lift" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%); padding: 30px; border-radius: 15px; margin: 30px 0; border-left: 4px solid var(--h2-color);">
                        <p style="font-size: 1.4em; font-weight: 600; margin: 0; color: var(--card-text);">
                            🔐 Build secure. Build with ASVS v5.0.
                        </p>
                    </div>

                    <div style="margin-top: 40px;">
                        <p style="font-size: 1.8em; color: var(--h2-color); font-weight: 600;">Thank You! 🎉</p>
                        <p style="font-size: 1.2em; color: var(--subtitle-color); margin-top: 10px;">Questions & Discussion</p>
                    </div>
                </div>

                <!-- Right side: Visual Impact -->
                <div style="display: flex; flex-direction: column; gap: 20px;">
                    <!-- Security Shield Image -->
                    <div style="position: relative; border-radius: 20px; overflow: hidden; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);">
                        <img src="https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=800&h=500&fit=crop" alt="Security" style="width: 100%; height: 300px; object-fit: cover;">
                        <div style="position: absolute; inset: 0; background: linear-gradient(135deg, rgba(59, 130, 246, 0.4) 0%, rgba(139, 92, 246, 0.4) 100%);"></div>
                        <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center;">
                            <div style="font-size: 120px; filter: drop-shadow(0 0 30px rgba(255, 255, 255, 0.5));">🛡️</div>
                        </div>
                    </div>

                    <!-- Stats Grid -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="hover-lift" style="background: var(--card-bg); padding: 20px; border-radius: 12px; text-align: center; border: var(--card-border-width) solid var(--card-border);">
                            <div style="font-size: 2.5em; font-weight: 700; color: var(--h2-color);">17</div>
                            <div style="font-size: 0.9em; color: var(--subtitle-color); margin-top: 5px;">ASVS Chapters</div>
                        </div>
                        <div class="hover-lift" style="background: var(--card-bg); padding: 20px; border-radius: 12px; text-align: center; border: var(--card-border-width) solid var(--card-border);">
                            <div style="font-size: 2.5em; font-weight: 700; color: var(--h3-color);">300+</div>
                            <div style="font-size: 0.9em; color: var(--subtitle-color); margin-top: 5px;">Requirements</div>
                        </div>
                        <div class="hover-lift" style="background: var(--card-bg); padding: 20px; border-radius: 12px; text-align: center; border: var(--card-border-width) solid var(--card-border);">
                            <div style="font-size: 2.5em; font-weight: 700; color: #4ade80;">80%+</div>
                            <div style="font-size: 0.9em; color: var(--subtitle-color); margin-top: 5px;">Risk Reduction</div>
                        </div>
                        <div class="hover-lift" style="background: var(--card-bg); padding: 20px; border-radius: 12px; text-align: center; border: var(--card-border-width) solid var(--card-border);">
                            <div style="font-size: 2.5em; font-weight: 700; color: #fb923c;">v5.0</div>
                            <div style="font-size: 0.9em; color: var(--subtitle-color); margin-top: 5px;">Latest</div>
                        </div>
                    </div>

                    <!-- Code Lock Visual -->
                    <div class="hover-lift" style="background: var(--code-bg); padding: 15px; border-radius: 10px; font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace; font-size: 0.85em; border: var(--code-border-width) solid var(--code-border);">
                        <span style="color: var(--keyword-color);">const</span> <span style="color: var(--code-text);">security</span> <span style="color: var(--code-text);">=</span> <span style="color: var(--string-color);">"built-in"</span><span style="color: var(--code-text);">;</span> <span style="color: var(--comment-color);">// ✓</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="slide-number" id="slideNumber" onclick="toggleSlideSelector()">1 - 44</div>
    
    <div class="slide-selector" id="slideSelector">
        <div class="slide-selector-header">
            <span>Jump to Slide</span>
            <input 
                type="number" 
                id="slideJumpInput" 
                class="slide-jump-input" 
                min="1" 
                max="44" 
                placeholder="1 / 44"
                title="Enter slide number and press Enter"
            />
        </div>
        <div id="slideSelectorList"></div>
    </div>

    <div class="controls">
        <button class="btn nav-btn" id="prevBtn" onclick="changeSlide(-1)" title="Previous Slide">←</button>
        <button class="btn nav-btn" id="nextBtn" onclick="changeSlide(1)" title="Next Slide">→</button>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function showSlide(n) {
            slides[currentSlide].classList.remove('active');
            currentSlide = (n + totalSlides) % totalSlides;
            slides[currentSlide].classList.add('active');
            
            document.getElementById('slideNumber').textContent = `${currentSlide + 1} / ${totalSlides}`;
            
            document.getElementById('prevBtn').disabled = currentSlide === 0;
            document.getElementById('nextBtn').disabled = currentSlide === totalSlides - 1;
            
            updateSlideSelector();
            
            // Update hash without triggering page scroll
            history.replaceState(null, null, `#slide-${currentSlide + 1}`);
            
            // Apply code expansion state to new slide
            applyCodeExpansionState();
            
            // Recalculate annotation mask widths for the new slide
            // Use requestAnimationFrame + setTimeout to ensure slide is fully rendered
            requestAnimationFrame(() => {
                setTimeout(() => {
                    applyAnnotationMaskWidths();
                }, 100);
            });
        }

        function toggleSlideSelector() {
            const selector = document.getElementById('slideSelector');
            selector.classList.toggle('active');
            
            // Focus the input field when dropdown is opened
            if (selector.classList.contains('active')) {
                const slideJumpInput = document.getElementById('slideJumpInput');
                if (slideJumpInput) {
                    // Small delay to ensure dropdown animation starts smoothly
                    setTimeout(() => {
                        slideJumpInput.focus();
                        slideJumpInput.select(); // Also select any existing value for easy replacement
                    }, 100);
                }
            }
        }

        function jumpToSlide(index) {
            showSlide(index);
            document.getElementById('slideSelector').classList.remove('active');
        }

        function updateSlideSelector() {
            const items = document.querySelectorAll('.slide-selector-item');
            items.forEach((item, index) => {
                if (index === currentSlide) {
                    item.classList.add('current');
                } else {
                    item.classList.remove('current');
                }
            });
        }

        function initSlideSelector() {
            const list = document.getElementById('slideSelectorList');
            const slideTitles = [];
            
            slides.forEach((slide, index) => {
                const h2 = slide.querySelector('h2');
                const h1 = slide.querySelector('h1');
                let title;
                
                // Special handling for title slide (slide 1)
                if (index === 0 && h1 && h1.textContent.includes('ASVS')) {
                    title = 'ASVS v5.0';
                }
                // Special handling for Thank You slide (last slide - slide 44)
                else if (slide.textContent.includes('Thank You') && slide.textContent.includes('Questions & Discussion')) {
                    title = 'Thank You! 🎉';
                } else {
                    title = h2 ? h2.textContent : `Slide ${index + 1}`;
                }
                
                slideTitles.push(title);
                
                const item = document.createElement('div');
                item.className = 'slide-selector-item';
                
                // Create circular badge for slide number
                const numberBadge = document.createElement('span');
                numberBadge.className = 'slide-number-badge';
                numberBadge.textContent = index + 1;
                
                // Create title text
                const titleText = document.createElement('span');
                titleText.textContent = title;
                
                item.appendChild(numberBadge);
                item.appendChild(titleText);
                item.onclick = () => jumpToSlide(index);
                list.appendChild(item);
            });
            
            updateSlideSelector();
        }

        function changeSlide(direction) {
            showSlide(currentSlide + direction);
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            // Ctrl+/ (Windows/Linux) or Cmd+/ (macOS) to open slide selector dropdown
            if ((e.ctrlKey || e.metaKey) && e.key === '/') {
                e.preventDefault(); // Prevent browser default behavior
                const selector = document.getElementById('slideSelector');
                if (!selector.classList.contains('active')) {
                    toggleSlideSelector();
                }
                return;
            }
            
            if (e.key === 'ArrowLeft' && currentSlide > 0) {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight' && currentSlide < totalSlides - 1) {
                changeSlide(1);
            }
        });

        // Close slide selector when clicking outside
        document.addEventListener('click', (e) => {
            const selector = document.getElementById('slideSelector');
            const slideNumber = document.getElementById('slideNumber');
            if (!selector.contains(e.target) && !slideNumber.contains(e.target)) {
                selector.classList.remove('active');
            }
        });

        // Theme toggle functionality with page refresh
        function toggleTheme() {
            const currentTheme = localStorage.getItem('theme') || 'dark';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            // Save new theme
            localStorage.setItem('theme', newTheme);
            
            // Save current slide position
            window.location.hash = `slide-${currentSlide + 1}`;
            
            // Reload page to apply theme consistently
            window.location.reload();
        }

        // Load saved theme preference
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const body = document.body;
            const themeIcon = document.getElementById('themeIcon');
            
            if (savedTheme === 'light') {
                body.classList.add('light-theme');
                themeIcon.textContent = '🌙'; // Show moon in light mode (click to go dark)
            } else {
                themeIcon.textContent = '☀️'; // Show sun in dark mode (click to go light)
            }
        }
        
        // Restore slide position from hash
        function restoreSlideFromHash() {
            const hash = window.location.hash;
            if (hash && hash.startsWith('#slide-')) {
                const slideNum = parseInt(hash.replace('#slide-', '')) - 1;
                if (slideNum >= 0 && slideNum < totalSlides) {
                    return slideNum;
                }
            }
            return 0;
        }

        // Timer functionality
        let timerInterval = null;
        let timerSeconds = 0;
        let timerRunning = false;
        let isCountdown = false;
        let initialTimerSeconds = 0;
        let isInputMode = false;

        function updateTimerDisplay() {
            const minutes = Math.floor(timerSeconds / 60);
            const seconds = timerSeconds % 60;
            const display = document.getElementById('timerDisplay');
            display.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            
            // Change color when countdown reaches 0
            if (isCountdown && timerSeconds === 0) {
                display.style.color = '#ef4444';
            } else if (isCountdown && timerSeconds <= 10) {
                display.style.color = '#f97316';
            } else {
                display.style.color = '';
            }
        }

        function playTimerSound() {
            // Create a gentle, ear-friendly notification sound
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Play a pleasant repeating chime pattern for 3 seconds
                const playTone = (frequency, startTime, duration) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = frequency;
                    oscillator.type = 'sine'; // Smooth sine wave
                    
                    // 30% volume with fade out
                    gainNode.gain.setValueAtTime(0, startTime);
                    gainNode.gain.linearRampToValueAtTime(0.3, startTime + 0.02); // 30% volume
                    gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
                    
                    oscillator.start(startTime);
                    oscillator.stop(startTime + duration);
                };
                
                const now = audioContext.currentTime;
                // Play repeating two-tone pattern over 5 seconds (C5 -> E5, repeated)
                playTone(523.25, now, 0.4);         // C5 note
                playTone(659.25, now + 0.2, 0.5);   // E5 note
                playTone(523.25, now + 0.8, 0.4);   // C5 note
                playTone(659.25, now + 1.0, 0.5);   // E5 note
                playTone(523.25, now + 1.6, 0.4);   // C5 note
                playTone(659.25, now + 1.8, 0.5);   // E5 note
                playTone(523.25, now + 2.4, 0.4);   // C5 note
                playTone(659.25, now + 2.6, 0.5);   // E5 note
                playTone(523.25, now + 3.2, 0.4);   // C5 note
                playTone(659.25, now + 3.4, 0.5);   // E5 note
                playTone(523.25, now + 4.0, 0.4);   // C5 note
                playTone(659.25, now + 4.2, 0.7);   // E5 note (final, longer)
                
            } catch (error) {
                console.log('Audio playback not supported');
            }
        }

        function validateTimerInput(input, max) {
            // Remove any non-digit characters except empty string
            let value = input.value.replace(/[^0-9]/g, '');
            
            // Convert to integer
            let numValue = parseInt(value) || 0;
            
            // Ensure it's within bounds
            if (numValue < 0) numValue = 0;
            if (numValue > max) numValue = max;
            
            // Update input value
            input.value = value === '' ? '' : numValue;
        }

        function incrementMinutes(e) {
            e.preventDefault();
            e.stopPropagation();
            const input = document.getElementById('timerMinutes');
            let value = parseInt(input.value) || 0;
            input.value = Math.min(value + 1, 99);
        }

        function decrementMinutes(e) {
            e.preventDefault();
            e.stopPropagation();
            const input = document.getElementById('timerMinutes');
            let value = parseInt(input.value) || 0;
            input.value = Math.max(value - 1, 0);
        }

        function incrementSeconds(e) {
            e.preventDefault();
            e.stopPropagation();
            const input = document.getElementById('timerSeconds');
            let value = parseInt(input.value) || 0;
            input.value = Math.min(value + 1, 59);
        }

        function decrementSeconds(e) {
            e.preventDefault();
            e.stopPropagation();
            const input = document.getElementById('timerSeconds');
            let value = parseInt(input.value) || 0;
            input.value = Math.max(value - 1, 0);
        }

        function toggleTimerInput() {
            const display = document.getElementById('timerDisplay');
            const inputGroup = document.getElementById('timerInputGroup');
            const setBtn = document.getElementById('timerSet');
            const startBtn = document.getElementById('timerStart');
            
            if (!isInputMode) {
                // Switch to input mode
                display.style.display = 'none';
                inputGroup.style.display = 'flex';
                setBtn.textContent = 'Done';
                isInputMode = true;
                
                // Populate inputs with current time
                const minutes = Math.floor(timerSeconds / 60);
                const seconds = timerSeconds % 60;
                document.getElementById('timerMinutes').value = minutes;
                document.getElementById('timerSeconds').value = seconds;
            } else {
                // Switch to display mode and apply values
                const minutes = parseInt(document.getElementById('timerMinutes').value) || 0;
                const seconds = parseInt(document.getElementById('timerSeconds').value) || 0;
                
                // Validate and set timer
                timerSeconds = Math.max(0, Math.min(minutes * 60 + seconds, 5999)); // Max 99:59
                initialTimerSeconds = timerSeconds;
                isCountdown = timerSeconds > 0;
                
                display.style.display = 'block';
                inputGroup.style.display = 'none';
                setBtn.textContent = 'Set';
                startBtn.disabled = false;
                startBtn.style.opacity = '1';
                isInputMode = false;
                
                updateTimerDisplay();
            }
        }

        function startTimer() {
            // If in input mode, apply the values first
            if (isInputMode) {
                const display = document.getElementById('timerDisplay');
                const inputGroup = document.getElementById('timerInputGroup');
                const setBtn = document.getElementById('timerSet');
                const startBtn = document.getElementById('timerStart');
                
                // Get and validate input values
                const minutes = parseInt(document.getElementById('timerMinutes').value) || 0;
                const seconds = parseInt(document.getElementById('timerSeconds').value) || 0;
                
                // Set timer
                timerSeconds = Math.max(0, Math.min(minutes * 60 + seconds, 5999)); // Max 99:59
                initialTimerSeconds = timerSeconds;
                isCountdown = timerSeconds > 0;
                
                // Switch back to display mode
                display.style.display = 'block';
                inputGroup.style.display = 'none';
                setBtn.textContent = 'Set';
                startBtn.disabled = false;
                startBtn.style.opacity = '1';
                isInputMode = false;
                
                updateTimerDisplay();
            }
            
            if (timerRunning) {
                // Pause timer
                clearInterval(timerInterval);
                timerRunning = false;
                document.getElementById('timerStart').textContent = 'Resume';
            } else {
                // Start/Resume timer
                timerRunning = true;
                document.getElementById('timerStart').textContent = 'Pause';
                timerInterval = setInterval(() => {
                    if (isCountdown) {
                        timerSeconds--;
                        updateTimerDisplay();
                        
                        // Stop at 0 and play alert
                        if (timerSeconds <= 0) {
                            timerSeconds = 0;
                            clearInterval(timerInterval);
                            timerRunning = false;
                            document.getElementById('timerStart').textContent = 'Start';
                            updateTimerDisplay();
                            
                            // Play gentle notification sound
                            playTimerSound();
                            
                            // Visual alert - flash the timer
                            const display = document.getElementById('timerDisplay');
                            let flashCount = 0;
                            const flashInterval = setInterval(() => {
                                display.style.opacity = display.style.opacity === '0.3' ? '1' : '0.3';
                                flashCount++;
                                if (flashCount >= 6) {
                                    clearInterval(flashInterval);
                                    display.style.opacity = '1';
                                }
                            }, 300);
                        }
                    } else {
                        timerSeconds++;
                        updateTimerDisplay();
                    }
                }, 1000);
            }
        }

        function resetTimer() {
            clearInterval(timerInterval);
            timerSeconds = isCountdown ? initialTimerSeconds : 0;
            timerRunning = false;
            updateTimerDisplay();
            document.getElementById('timerStart').textContent = 'Start';
        }

        function showTimer() {
            const timer = document.getElementById('codeTimer');
            const toggleBtn = document.getElementById('timerToggle');
            timer.classList.add('visible');
            toggleBtn.classList.add('active');
        }

        function hideTimer() {
            const timer = document.getElementById('codeTimer');
            const toggleBtn = document.getElementById('timerToggle');
            timer.classList.remove('visible');
            toggleBtn.classList.remove('active');
        }

        function toggleTimerVisibility() {
            const timer = document.getElementById('codeTimer');
            if (timer.classList.contains('visible')) {
                hideTimer();
            } else {
                showTimer();
            }
        }

        // Make timer draggable
        let isDragging = false;
        let currentX;
        let currentY;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;

        function initTimerDragging() {
            const timer = document.getElementById('codeTimer');
            
            timer.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);
            
            // Touch events for mobile
            timer.addEventListener('touchstart', dragStart);
            document.addEventListener('touchmove', drag);
            document.addEventListener('touchend', dragEnd);
        }

        function dragStart(e) {
            const timer = document.getElementById('codeTimer');
            
            // Don't drag if clicking on buttons, inputs, or spinner buttons
            if (e.target.classList.contains('timer-btn') || 
                e.target.classList.contains('timer-input') ||
                e.target.classList.contains('timer-spinner-btn')) {
                return;
            }
            
            if (e.type === 'touchstart') {
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
            } else {
                initialX = e.clientX - xOffset;
                initialY = e.clientY - yOffset;
            }

            if (e.target === timer || timer.contains(e.target)) {
                isDragging = true;
                timer.classList.add('dragging');
            }
        }

        function drag(e) {
            if (isDragging) {
                e.preventDefault();
                
                const timer = document.getElementById('codeTimer');
                
                if (e.type === 'touchmove') {
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;
                } else {
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;
                }

                xOffset = currentX;
                yOffset = currentY;

                // Get timer dimensions
                const timerRect = timer.getBoundingClientRect();
                const timerWidth = timerRect.width;
                const timerHeight = timerRect.height;

                // Calculate new position
                let newLeft = timer.offsetLeft + currentX - xOffset + currentX;
                let newTop = timer.offsetTop + currentY - yOffset + currentY;

                // Keep within viewport bounds
                newLeft = Math.max(0, Math.min(newLeft, window.innerWidth - timerWidth));
                newTop = Math.max(0, Math.min(newTop, window.innerHeight - timerHeight));

                setTranslate(currentX, currentY, timer);
            }
        }

        function dragEnd(e) {
            if (isDragging) {
                const timer = document.getElementById('codeTimer');
                initialX = currentX;
                initialY = currentY;
                isDragging = false;
                timer.classList.remove('dragging');
            }
        }

        function setTranslate(xPos, yPos, el) {
            el.style.transform = `translate3d(${xPos}px, ${yPos}px, 0)`;
        }

        // Transform code blocks to have line numbers
        function initCodeBlocks() {
            const codeBlocks = document.querySelectorAll('.code-block');
            
            codeBlocks.forEach(block => {
                // Skip if already processed
                if (block.querySelector('.code-block-content')) {
                    return;
                }
                
                // Get the original content
                const originalContent = block.innerHTML;
                
                // Split into lines
                const lines = originalContent.split('\n');
                
                // Create new structure with table layout
                const contentWrapper = document.createElement('div');
                contentWrapper.className = 'code-block-content';
                
                const table = document.createElement('div');
                table.className = 'code-block-table';
                
                // Add each line as a table row
                lines.forEach((line, index) => {
                    const row = document.createElement('div');
                    row.className = 'code-block-row';
                    row.dataset.line = index;
                    
                    const lineNumber = document.createElement('div');
                    lineNumber.className = 'code-line-number';
                    lineNumber.textContent = index + 1;
                    
                    const codeLine = document.createElement('div');
                    codeLine.className = 'code-line';
                    codeLine.innerHTML = line || ' '; // Preserve empty lines
                    
                    // Check if this line contains VULNERABILITY or ASVS annotation comments
                    const lineText = line.replace(/<[^>]*>/g, ''); // Strip HTML tags for checking
                    if (lineText.includes('VULNERABILITY') || lineText.match(/V\d+\.\d+\.\d+/)) {
                        codeLine.classList.add('annotation-comment');
                        codeLine.classList.add('mask-hidden'); // Start with mask visible by default
                        // Store original line for width calculation later
                        codeLine.dataset.hasAnnotation = 'true';
                        
                        // Add individual click handler for toggling this specific annotation
                        codeLine.addEventListener('click', (e) => {
                            e.stopPropagation(); // Prevent line selection
                            toggleIndividualMask(codeLine);
                        });
                        
                        // Add cursor pointer and tooltip to indicate clickability
                        codeLine.style.cursor = 'pointer';
                        codeLine.title = 'Click to reveal this annotation';
                    }
                    
                    row.appendChild(lineNumber);
                    row.appendChild(codeLine);
                    table.appendChild(row);
                    
                    // Add click handler for line selection (only if not an annotation)
                    if (!lineText.includes('VULNERABILITY') && !lineText.match(/V\d+\.\d+\.\d+/)) {
                        row.addEventListener('click', () => {
                            toggleLineSelection(block, index);
                        });
                    }
                });
                
                // Clear original content and add new structure
                block.innerHTML = '';
                contentWrapper.appendChild(table);
                block.appendChild(contentWrapper);
                
                // Check if block has any annotation comments
                const hasAnnotations = originalContent.includes('VULNERABILITY') || 
                                      originalContent.match(/V\d+\.\d+\.\d+/);
                
                // Add toggle comments button if annotations exist
                if (hasAnnotations) {
                    // Start with annotations masked by default
                    block.classList.add('hide-annotations');
                    
                    const toggleCommentsBtn = document.createElement('button');
                    toggleCommentsBtn.className = 'code-toggle-comments-btn comments-hidden';
                    toggleCommentsBtn.textContent = '🔒';
                    toggleCommentsBtn.title = 'Reveal All Annotations (VULNERABILITY/ASVS comments)';
                    toggleCommentsBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        toggleAnnotations(block, toggleCommentsBtn);
                    });
                    block.appendChild(toggleCommentsBtn);
                }
                
                // Add expand/collapse button
                const expandBtn = document.createElement('button');
                expandBtn.className = 'code-expand-btn';
                expandBtn.textContent = '⛶';
                expandBtn.title = 'Expand/Collapse Code';
                expandBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleCodeExpansion(block, expandBtn);
                });
                block.appendChild(expandBtn);
            });
            
            // Calculate and apply mask widths for annotation comments after DOM rendering
            setTimeout(() => {
                applyAnnotationMaskWidths();
            }, 100);
        }
        
        // Calculate mask width based on comment span width
        function applyAnnotationMaskWidths() {
            // Only process visible annotation lines (in the current slide)
            const currentSlideElement = slides[currentSlide];
            if (!currentSlideElement) return;
            
            const annotationLines = currentSlideElement.querySelectorAll('.annotation-comment');
            
            annotationLines.forEach(line => {
                // Find the comment span element
                const commentSpan = line.querySelector('.comment');
                
                if (commentSpan) {
                    // Force a reflow to ensure dimensions are correct
                    void line.offsetHeight;
                    
                    // Get the bounding rectangle of the comment span
                    const rect = commentSpan.getBoundingClientRect();
                    const lineRect = line.getBoundingClientRect();
                    
                    // Only apply if elements are actually visible (width > 0)
                    if (rect.width > 0 && lineRect.width > 0) {
                        // Calculate the start position (left offset from line start)
                        const startOffset = rect.left - lineRect.left;
                        
                        // Calculate the width of the comment
                        const commentWidth = rect.width;
                        
                        // Apply custom CSS properties for the mask
                        line.style.setProperty('--mask-left', `${startOffset}px`);
                        line.style.setProperty('--mask-width', `${commentWidth}px`);
                        line.classList.add('has-measured-mask');
                    }
                }
            });
        }
        
        function toggleLineSelection(block, lineIndex) {
            const row = block.querySelector(`.code-block-row[data-line="${lineIndex}"]`);
            
            if (row) {
                // Toggle selection
                const isSelected = row.classList.contains('selected');
                
                if (isSelected) {
                    row.classList.remove('selected');
                } else {
                    // Remove previous selections in this block
                    block.querySelectorAll('.code-block-row.selected').forEach(el => el.classList.remove('selected'));
                    
                    // Add new selection
                    row.classList.add('selected');
                }
            }
        }

        // Global code expansion state with localStorage persistence
        let isCodeExpandedGlobally = localStorage.getItem('codeExpanded') === 'true';

        function toggleCodeExpansion(block, button) {
            const isExpanded = block.classList.contains('expanded');
            
            // Find the parent slide
            const slide = block.closest('.slide');
            
            if (isExpanded) {
                // Collapse
                block.classList.remove('expanded');
                button.textContent = '⛶';
                button.title = 'Expand Code';
                document.body.style.overflow = '';
                
                // Update global state and localStorage
                isCodeExpandedGlobally = false;
                localStorage.setItem('codeExpanded', 'false');
                
                // Remove slide-right class from vulnerability and secure boxes
                if (slide) {
                    const vulnerabilityBoxes = slide.querySelectorAll('.vulnerability-box');
                    const secureBoxes = slide.querySelectorAll('.secure-box');
                    
                    vulnerabilityBoxes.forEach(box => {
                        box.classList.remove('slide-right');
                        // Reset inline styles
                        box.style.top = '';
                        box.style.bottom = '';
                        box.style.maxHeight = '';
                    });
                    secureBoxes.forEach(box => {
                        box.classList.remove('slide-right');
                        // Reset inline styles
                        box.style.top = '';
                        box.style.bottom = '';
                        box.style.maxHeight = '';
                    });
                }
            } else {
                // Expand
                block.classList.add('expanded');
                button.textContent = '⛶';
                button.title = 'Collapse Code';
                document.body.style.overflow = 'hidden';
                
                // Update global state and localStorage
                isCodeExpandedGlobally = true;
                localStorage.setItem('codeExpanded', 'true');
                
                // Add slide-right class to vulnerability and secure boxes
                if (slide) {
                    const vulnerabilityBoxes = slide.querySelectorAll('.vulnerability-box');
                    const secureBoxes = slide.querySelectorAll('.secure-box');
                    
                    // Collect all boxes in order they appear in the DOM
                    const allBoxes = [];
                    slide.querySelectorAll('.vulnerability-box, .secure-box').forEach(box => {
                        if (box.closest('.slide') === slide) {
                            allBoxes.push(box);
                        }
                    });
                    
                    // Add slide-right class and position boxes from bottom to top
                    const totalBoxes = allBoxes.length;
                    if (totalBoxes === 1) {
                        allBoxes[0].classList.add('slide-right');
                    } else if (totalBoxes > 1) {
                        const boxHeight = `calc((100vh - ${(totalBoxes + 1) * 10}px) / ${totalBoxes})`;
                        // Position boxes from bottom to top (reverse order)
                        allBoxes.forEach((box, index) => {
                            box.classList.add('slide-right');
                            const reverseIndex = totalBoxes - 1 - index;
                            box.style.top = 'auto';
                            box.style.bottom = `${20 + (reverseIndex * (100 / totalBoxes))}vh`;
                            box.style.maxHeight = boxHeight;
                        });
                    }
                }
            }
            
            // Recalculate mask widths after expansion/collapse animation completes
            setTimeout(() => {
                applyAnnotationMaskWidths();
            }, 100);
        }

        // Toggle annotation comments (VULNERABILITY and ASVS comments)
        function toggleAnnotations(block, button) {
            const isHidden = block.classList.contains('hide-annotations');
            
            if (isHidden) {
                // Reveal all annotations with animation
                block.classList.remove('hide-annotations');
                button.classList.remove('comments-hidden');
                
                // Also reveal all individual masks
                const annotations = block.querySelectorAll('.annotation-comment');
                annotations.forEach(annotation => {
                    annotation.classList.remove('mask-hidden');
                });
                button.textContent = '🔓';
                button.title = 'Mask All Annotations (VULNERABILITY/ASVS comments)';
            } else {
                // Mask all annotations with animation
                block.classList.add('hide-annotations');
                button.classList.add('comments-hidden');
                
                // Also hide all individual masks
                const annotations = block.querySelectorAll('.annotation-comment');
                annotations.forEach(annotation => {
                    annotation.classList.add('mask-hidden');
                });
                button.textContent = '🔒';
                button.title = 'Reveal All Annotations (VULNERABILITY/ASVS comments)';
            }
        }

        // Toggle individual annotation mask
        function toggleIndividualMask(annotationLine) {
            const isHidden = annotationLine.classList.contains('mask-hidden');
            
            if (isHidden) {
                // Reveal this specific annotation
                annotationLine.classList.remove('mask-hidden');
                annotationLine.title = 'Click to mask this annotation';
            } else {
                // Hide this specific annotation
                annotationLine.classList.add('mask-hidden');
                annotationLine.title = 'Click to reveal this annotation';
            }
        }

        // Recalculate mask widths on window resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                applyAnnotationMaskWidths();
            }, 150);
        });

        // Close expanded code block with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const expandedBlock = document.querySelector('.code-block.expanded');
                if (expandedBlock) {
                    const button = expandedBlock.querySelector('.code-expand-btn');
                    toggleCodeExpansion(expandedBlock, button);
                }
            }
        });

        // Apply code expansion state to current slide
        function applyCodeExpansionState() {
            const currentSlideElement = slides[currentSlide];
            const codeBlock = currentSlideElement.querySelector('.code-block');
            
            if (codeBlock) {
                const button = codeBlock.querySelector('.code-expand-btn');
                const isExpanded = codeBlock.classList.contains('expanded');
                
                // Apply global state if different from current state
                if (isCodeExpandedGlobally && !isExpanded) {
                    toggleCodeExpansion(codeBlock, button);
                } else if (!isCodeExpandedGlobally && isExpanded) {
                    toggleCodeExpansion(codeBlock, button);
                }
            }
        }

        // Wrap slide content for sticky headers
        function initSlideStickyHeaders() {
            const slides = document.querySelectorAll('.slide');
            
            slides.forEach(slide => {
                // Skip if already processed
                if (slide.querySelector('.slide-content')) {
                    return;
                }
                
                // Find the h2 title (should be the first child or early in the slide)
                const h2 = slide.querySelector('h2');
                
                if (h2) {
                    // Create a wrapper for all content except h2
                    const contentWrapper = document.createElement('div');
                    contentWrapper.className = 'slide-content';
                    
                    // Move all children except h2 into the wrapper
                    const children = Array.from(slide.children);
                    children.forEach(child => {
                        if (child !== h2) {
                            contentWrapper.appendChild(child);
                        }
                    });
                    
                    // Add the wrapper back to the slide
                    slide.appendChild(contentWrapper);
                }
            });
        }

        // Initialize
        loadTheme();
        initSlideSelector();
        initSlideStickyHeaders();
        initCodeBlocks();
        initTimerDragging();
        const initialSlide = restoreSlideFromHash();
        showSlide(initialSlide);
        
        // Set keyboard shortcut hint based on platform
        const isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;
        const shortcutKey = isMac ? 'Cmd+/' : 'Ctrl+/';
        document.getElementById('slideNumber').title = `Click or press ${shortcutKey} to jump to slide`;
        
        // Apply saved code expansion state on page load
        if (isCodeExpandedGlobally) {
            applyCodeExpansionState();
        }

        // Setup slide jump input
        const slideJumpInput = document.getElementById('slideJumpInput');
        
        // Real-time validation as user types
        slideJumpInput.addEventListener('input', (e) => {
            const value = slideJumpInput.value;
            
            // Allow empty value (user is clearing)
            if (value === '') {
                return;
            }
            
            const slideNum = parseInt(value);
            
            // Check if it's a valid number within range
            if (isNaN(slideNum) || slideNum < 1 || slideNum > totalSlides) {
                // Invalid input - trigger shake animation
                slideJumpInput.classList.add('shake');
                
                // Remove shake class after animation completes
                setTimeout(() => {
                    slideJumpInput.classList.remove('shake');
                }, 300);
                
                // Prevent invalid value - revert to previous valid value or empty
                e.preventDefault();
                slideJumpInput.value = '';
            }
        });
        
        // Prevent typing invalid characters
        slideJumpInput.addEventListener('keydown', (e) => {
            // Allow: backspace, delete, tab, escape, enter
            if ([8, 9, 27, 13, 46].indexOf(e.keyCode) !== -1 ||
                // Allow: Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
                (e.keyCode === 65 && e.ctrlKey === true) ||
                (e.keyCode === 67 && e.ctrlKey === true) ||
                (e.keyCode === 86 && e.ctrlKey === true) ||
                (e.keyCode === 88 && e.ctrlKey === true) ||
                // Allow: home, end, left, right
                (e.keyCode >= 35 && e.keyCode <= 39)) {
                
                // Handle Enter key for jumping
                if (e.key === 'Enter') {
                    const slideNum = parseInt(slideJumpInput.value);
                    if (slideNum >= 1 && slideNum <= totalSlides) {
                        jumpToSlide(slideNum - 1); // Convert to 0-based index
                        slideJumpInput.value = ''; // Clear input
                    }
                }
                return;
            }
            
            // Ensure it's a number
            if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && 
                (e.keyCode < 96 || e.keyCode > 105)) {
                e.preventDefault();
            }
        });

        // Prevent paste of invalid content
        slideJumpInput.addEventListener('paste', (e) => {
            e.preventDefault();
            const pasteData = (e.clipboardData || window.clipboardData).getData('text');
            const slideNum = parseInt(pasteData);
            
            if (!isNaN(slideNum) && slideNum >= 1 && slideNum <= totalSlides) {
                slideJumpInput.value = slideNum;
            } else {
                // Trigger shake for invalid paste
                slideJumpInput.classList.add('shake');
                setTimeout(() => {
                    slideJumpInput.classList.remove('shake');
                }, 300);
            }
        });

        // Update max attribute and placeholder when slides are loaded
        slideJumpInput.max = totalSlides;
        slideJumpInput.placeholder = `1 - ${totalSlides}`;
    </script>
</body>
</html>